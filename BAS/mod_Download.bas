Attribute VB_Name = "mod_Download"
Public Declare Function GetTickCount Lib "kernel32" () As Long

Public Function GetFilename(strUrl As String) As String
    Dim i As Integer
    i = InStrRev(strUrl, "/")
    GetFilename = Mid(strUrl, i + 1)
End Function

Public Function ParseUrl(ByVal strUrl As String, _
                          ByRef strHost As String, _
                          ByRef strPort As String, _
                          ByRef strRequest As String)
    Dim i As Integer
    Dim x As Integer
    Dim strSub As String
    
    If LCase(Left(strUrl, Len("http://"))) = "http://" Then
        'http:// exists?
        strUrl = Mid(strUrl, Len("http://") + 1)
    End If
    
    If LCase(Left(strUrl, Len("www."))) = "www." Then
        'www. exists?
        strUrl = Mid(strUrl, Len("www.") + 1)
    End If
    
    i = InStr(strUrl, "/")
    If Not i = 0 Then
        strRequest = Mid(strUrl, i)
        strSub = Left(strUrl, i - 1)
        i = InStr(strSub, ":")
        If Not i = 0 Then
            strPort = Mid(strSub, i + 1)
            strHost = Left(strSub, i - 1)
        Else
            strPort = 80
            strHost = strSub
        End If
    Else
        strRequest = "/"
        i = InStr(strUrl, ":")
        If Not i = 0 Then
            strPort = Mid(strUrl, i + 1)
            strHost = Left(strUrl, i - 1)
        Else
            strPort = 80
            strHost = strUrl
        End If
    End If
End Function

Function FileExists(File As String) As Boolean
   On Error Resume Next
   FileExists = False
   FileExists = Dir(File) <> ""
End Function
