VERSION 5.00
Object = "{248DD890-BB45-11CF-9ABC-0080C7E7B78D}#1.0#0"; "Mswinsck.ocx"
Begin VB.Form ircbott 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Malware Auto-Downloader v1.7 - xylitol@malwareint.com"
   ClientHeight    =   4695
   ClientLeft      =   5220
   ClientTop       =   3045
   ClientWidth     =   8670
   Icon            =   "ircbot.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   ScaleHeight     =   313
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   578
   StartUpPosition =   2  'CenterScreen
   Begin VB.TextBox txtBuffer 
      Height          =   2895
      Index           =   0
      Left            =   1200
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   0
      Top             =   120
      Width           =   7335
   End
   Begin VB.TextBox txtBuffer 
      Height          =   2895
      Index           =   1
      Left            =   1200
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   3
      Top             =   120
      Width           =   7335
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Left            =   120
      TabIndex        =   20
      Text            =   "need one liter of coffee"
      Top             =   4320
      Width           =   6495
   End
   Begin VB.CommandButton Command4 
      Caption         =   "Send (/me)"
      Height          =   285
      Left            =   6720
      TabIndex        =   19
      Top             =   4320
      Width           =   1815
   End
   Begin VB.TextBox byechan 
      Height          =   285
      Left            =   5160
      TabIndex        =   18
      Text            =   "PART #Support"
      Top             =   7320
      Width           =   3375
   End
   Begin VB.TextBox byebye 
      Height          =   285
      Left            =   840
      TabIndex        =   17
      Text            =   "QUIT »» MAD v1.7.5 «» Disconnect"
      Top             =   7320
      Visible         =   0   'False
      Width           =   4215
   End
   Begin MSWinsockLib.Winsock Winsock1 
      Left            =   5640
      Top             =   6360
      _ExtentX        =   741
      _ExtentY        =   741
      _Version        =   393216
      RemoteHost      =   "google.com"
      RemotePort      =   80
   End
   Begin VB.Timer Timer2 
      Enabled         =   0   'False
      Interval        =   1
      Left            =   5160
      Top             =   6360
   End
   Begin VB.Timer Timer4 
      Interval        =   1000
      Left            =   5160
      Top             =   6000
   End
   Begin VB.Timer Timer1 
      Enabled         =   0   'False
      Interval        =   1
      Left            =   4800
      Top             =   6360
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Left            =   1200
      TabIndex        =   15
      Top             =   3960
      Width           =   5415
   End
   Begin VB.CommandButton Command6 
      Caption         =   "Register (NickServ!)"
      Height          =   255
      Left            =   1200
      TabIndex        =   14
      Top             =   3240
      Width           =   2295
   End
   Begin VB.CommandButton Command7 
      Caption         =   "Vhost (HotServ!)"
      Height          =   255
      Left            =   6240
      TabIndex        =   13
      Top             =   3240
      Width           =   2295
   End
   Begin VB.CommandButton Command8 
      Caption         =   "Identify (NickServ!)"
      Height          =   255
      Left            =   3720
      TabIndex        =   12
      Top             =   3240
      Width           =   2295
   End
   Begin VB.CommandButton Command3 
      Caption         =   "Prepare a message to"
      Height          =   255
      Left            =   1200
      TabIndex        =   11
      Top             =   3600
      Width           =   7335
   End
   Begin VB.CommandButton Command2 
      Caption         =   "Command2"
      Height          =   1215
      Left            =   8040
      TabIndex        =   10
      Top             =   7560
      Visible         =   0   'False
      Width           =   495
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Send cmd"
      Height          =   285
      Left            =   6720
      TabIndex        =   9
      Top             =   3960
      Width           =   1815
   End
   Begin VB.TextBox NewMalcodeFound 
      Height          =   285
      Left            =   840
      TabIndex        =   7
      Text            =   "NewMalcodeFound"
      Top             =   8040
      Visible         =   0   'False
      Width           =   7095
   End
   Begin VB.TextBox grabdata 
      Height          =   285
      Left            =   840
      TabIndex        =   6
      Text            =   "grabdata"
      Top             =   8400
      Visible         =   0   'False
      Width           =   7095
   End
   Begin VB.CheckBox Check2 
      Caption         =   "Log Raw"
      Height          =   255
      Left            =   120
      TabIndex        =   5
      Top             =   1560
      Width           =   3255
   End
   Begin VB.CheckBox Check1 
      Caption         =   "Log Chan"
      Height          =   255
      Left            =   120
      TabIndex        =   4
      Top             =   1200
      Width           =   3135
   End
   Begin VB.Timer Timer3 
      Enabled         =   0   'False
      Interval        =   1
      Left            =   4800
      Top             =   6000
   End
   Begin VB.OptionButton Option1 
      Caption         =   "Chan Text"
      Height          =   255
      Index           =   1
      Left            =   120
      TabIndex        =   2
      Top             =   600
      Width           =   3255
   End
   Begin VB.OptionButton Option1 
      Caption         =   "Raw Text"
      Height          =   255
      Index           =   0
      Left            =   120
      TabIndex        =   1
      Top             =   240
      Value           =   -1  'True
      Width           =   3255
   End
   Begin VB.Label letsgo 
      Caption         =   "Label3"
      Height          =   255
      Left            =   840
      TabIndex        =   23
      Top             =   6240
      Width           =   7335
   End
   Begin VB.Label ircstatut 
      Caption         =   "0"
      Height          =   255
      Left            =   840
      TabIndex        =   22
      Top             =   6600
      Width           =   2295
   End
   Begin VB.Label Label2 
      Caption         =   "Label2"
      Height          =   255
      Left            =   840
      TabIndex        =   21
      Top             =   6960
      Width           =   7695
   End
   Begin VB.Image Image1 
      Height          =   1575
      Left            =   105
      Picture         =   "ircbot.frx":058A
      Top             =   2640
      Width           =   990
   End
   Begin VB.Line Line4 
      X1              =   8
      X2              =   72
      Y1              =   64
      Y2              =   64
   End
   Begin VB.Line Line3 
      X1              =   8
      X2              =   72
      Y1              =   8
      Y2              =   8
   End
   Begin VB.Line Line2 
      X1              =   8
      X2              =   72
      Y1              =   168
      Y2              =   168
   End
   Begin VB.Line Line1 
      X1              =   8
      X2              =   72
      Y1              =   136
      Y2              =   136
   End
   Begin VB.Label Label1 
      Alignment       =   2  'Center
      Caption         =   "Time"
      Height          =   255
      Left            =   120
      TabIndex        =   16
      Top             =   2160
      Width           =   975
   End
   Begin VB.Label s3nd 
      Caption         =   "Label1"
      Height          =   255
      Left            =   840
      TabIndex        =   8
      Top             =   7680
      Visible         =   0   'False
      Width           =   7095
   End
   Begin VB.Menu main 
      Caption         =   "main"
      Visible         =   0   'False
      Begin VB.Menu show 
         Caption         =   "show"
      End
      Begin VB.Menu exit 
         Caption         =   "exit"
      End
   End
End
Attribute VB_Name = "ircbott"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
      Private Type NOTIFYICONDATA
       cbSize As Long
       hwnd As Long
       uId As Long
       uFlags As Long
       uCallBackMessage As Long
       hIcon As Long
       szTip As String * 64
      End Type
      Private Const NIM_ADD = &H0
      Private Const NIM_MODIFY = &H1
      Private Const NIM_DELETE = &H2
      Private Const NIF_MESSAGE = &H1
      Private Const NIF_ICON = &H2
      Private Const NIF_TIP = &H4
      Private Const WM_MOUSEMOVE = &H200
      Private Const WM_LBUTTONDOWN = &H201     'Button down
      Private Const WM_LBUTTONUP = &H202
      Private Const WM_LBUTTONDBLCLK = &H203
      Private Const WM_RBUTTONDOWN = &H204
      Private Const WM_RBUTTONUP = &H205
      Private Const WM_RBUTTONDBLCLK = &H206

      Private Declare Function SetForegroundWindow Lib "user32" _
      (ByVal hwnd As Long) As Long
      Private Declare Function Shell_NotifyIcon Lib "shell32" _
      Alias "Shell_NotifyIconA" _
      (ByVal dwMessage As Long, pnid As NOTIFYICONDATA) As Boolean
      Private nid As NOTIFYICONDATA
Private Type InData
   Nick As String
   Host As String
   Act As String
   To As String
   msg As String
   Err As Boolean
End Type
Private Type QOCINFO
  dwSize As Long
  dwFlags As Long
  
  dwInSpeed As Long
  dwOutSpeed As Long
End Type
Private Declare Function InternetCloseHandle Lib "wininet.dll" (ByVal hInet As Long) As Integer
Private Declare Function InternetConnect Lib "wininet.dll" Alias "InternetConnectA" (ByVal hInternetSession As Long, ByVal sServerName As String, ByVal nServerPort As Integer, ByVal sUserName As String, ByVal sPassword As String, ByVal lService As Long, ByVal lFlags As Long, ByVal lContext As Long) As Long
Private Declare Function InternetOpen Lib "wininet.dll" Alias "InternetOpenA" (ByVal sAgent As String, ByVal lAccessType As Long, ByVal sProxyName As String, ByVal sProxyBypass As String, ByVal lFlags As Long) As Long
Private Declare Function InternetOpenUrl Lib "wininet.dll" Alias "InternetOpenUrlA" (ByVal hInternetSession As Long, ByVal sURL As String, ByVal sHeaders As String, ByVal lHeadersLength As Long, ByVal lFlags As Long, ByVal lContext As Long) As Long
Private Declare Function InternetReadFile Lib "wininet.dll" (ByVal hFile As Long, ByVal sBuffer As String, ByVal lNumBytesToRead As Long, lNumberOfBytesRead As Long) As Integer
Private Declare Function IsNetworkAlive Lib "SENSAPI.DLL" (ByRef lpdwFlags As Long) As Long
Private Declare Function IsDestinationReachable Lib "SENSAPI.DLL" Alias "IsDestinationReachableA" (ByVal lpszDestination As String, ByRef lpQOCInfo As QOCINFO) As Long
Private Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long
Private Declare Function IsWindow Lib "user32" (ByVal hwnd As Long) As Long
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
Private Declare Function FindWindowX Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
Private Declare Function SetFileAttributes Lib "kernel32.dll" Alias "SetFileAttributesA" (ByVal lpFileName As String, ByVal dwFileAttributes As Long) As Long
Private Const BUFFER_LEN = 256
Private Const PassiveConnection As Boolean = True
Public IRCCHANNEL As String
Public IRCCHANNEL2 As String
Public IRCCHANNEL3 As String
Public IRCCHANNEL4 As String
Public IRCCHANNEL5 As String
Public IRCserver As String
Public IRCusername As String
Public IRCCHANNELPASS As String
Public IRCNICK As String
Public NSPASS As String
Public CPass As String
Dim c As InData
Dim z
Dim minute, Complete, joinR As Integer
Dim WithEvents sckIRC As CSocketMaster
Attribute sckIRC.VB_VarHelpID = -1
Dim rawr2, nnnR, addmalc0de, addmalc0de4, dldone, datetime, rainbowrawr, rainbowshit, calcz, RandomQuote(102), ConnectQuote(16), Parts(), kawa(2), chan, GChan As String
Dim cycle, Possible As Boolean

Private Sub Check1_Click()
If Check1.Value = 1 Then
Timer2.Enabled = True
ElseIf Check1.Value = 0 Then
Timer2.Enabled = False
End If
End Sub
Private Sub Check2_Click()
If Check2.Value = 1 Then
Timer3.Enabled = True
ElseIf Check2.Value = 0 Then
Timer3.Enabled = False
End If
End Sub

Private Sub Command1_Click()
sckIRC.SendData Text1.text & vbCrLf
End Sub

Private Sub Command2_Click()
sckIRC.SendData NewMalcodeFound.text & vbCrLf
End Sub

Private Sub Command3_Click()
Text1.text = "PRIVMSG " & frm_Main.IRCchan.text & " :"
End Sub

Private Sub Command4_Click()
sckIRC.SendData "PRIVMSG " & frm_Main.IRCchan.text & " :" & Chr$(1) & "ACTION " & Text2.text & Chr$(1) & vbCrLf
End Sub

Private Sub Command6_Click()
'/MSG NickServ REGISTER motdepasse email
Text1.text = "NickServ REGISTER yourpasswordhere youremail@here.fr"
End Sub

Private Sub Command7_Click()
'/msg HostServ request got.milk
Text1.text = "HotServ REQUEST Your.Vhost.here"
End Sub

Private Sub Command8_Click()
'NickServ IDENTIFY motdepasse
Text1.text = "NickServ IDENTIFY yourpassword"
End Sub

Private Sub Form_Load()
      IRCserver = frm_Main.IRCserver.text
     IRCCHANNEL = frm_Main.IRCchan.text
 IRCCHANNELPASS = frm_Main.IRCpasswordChan.text
          CPass = frm_Main.IRCnickserv.text
        IRCNICK = frm_Main.IRCpseudo.text
    IRCusername = frm_Main.IRCusername & frm_Main.Label39.Caption
         NSPASS = frm_Main.IRCnickserv.text
    Set sckIRC = New CSocketMaster
          With sckIRC
             .RemoteHost = IRCserver
             .RemotePort = frm_Main.IRCport.text
             .Connect
          End With
           Me.show
       Me.Refresh
       With nid
        .cbSize = Len(nid)
        .hwnd = Me.hwnd
        .uId = vbNull
        .uFlags = NIF_ICON Or NIF_TIP Or NIF_MESSAGE
        .uCallBackMessage = WM_MOUSEMOVE
        .hIcon = Me.Icon
        .szTip = "Ircbot" & vbNullChar
       End With
       frm_Main.ircform2.Caption = "1"
       Shell_NotifyIcon NIM_ADD, nid
       Me.WindowState = vbMinimized
          End Sub
 
Private Sub BotTriggers(irctext As String, name As String, bottype As Integer)
    If bottype = 0 Then ' Normal Text Response
       Dim pname As String
       pname = "." & IRCNICK
       If Left$(irctext, Len(pname)) = pname Then 'check for individual command
          If Len(irctext) > Len(pname) + 1 Then
             Dim tempstring As String
             tempstring = Right(irctext, Len(irctext) - Len(pname) - 1)
             irctext = tempstring
          End If
       End If
    End If
    Dim channel As String
    Dim nickname As String
    nickname = c.Nick
    channel = c.To
If Left$(LCase(irctext), 7) = "!admins" Then
Dim a3 As String
a3 = frm_Main.IRCpseudo.text
If name = a3 Then
sckIRC.SendData "PRIVMSG " & channel & " " & a3 & vbCrLf
    End If
    End If
    
If Left$(LCase(irctext), 9) = "!commands" Then
Dim cmd As String
cmd = "!say, !ip, !domain, !kawa, !downloadevery, !rainbow, !calc, !reverse, !end, !chktimeout, !declaretimeout, !quote, !start, !stop, !savelist, !statut, !reload, !add, !fixhours, !fixmin, !about, !op, !owner, !protect, !admin, !voice, !halfop, !devoice, !dehalfop, !deprotect, !deop, !deowner, !kick, !ban, !kb, !unban, !login"
SendText (cmd)
End If

'#### !RELOAD ######
If Left$(LCase(irctext), 7) = "!reload" Then
If nickname = frm_Main.IRCadmin.text Then
Unload Me
Else
Dim addmalc0de2 As String
              addmalc0de2 = "[MAD] No way."
              SendText (addmalc0de2)
End If
End If

 '##### !SAY #####
             If Left$(LCase(irctext), 4) = "!say" Then
 If Len(irctext) > 5 Then
                Dim rawr As String
                rawr = Right(irctext, Len(irctext) - 5)
               sckIRC.SendData "PRIVMSG " & channel & " :" & rawr & vbCrLf
             End If
             End If

 '##### !RAINBOW #####
             If Left$(LCase(irctext), 8) = "!rainbow" Then
 If Len(irctext) > 9 Then
     
                rawr = Right(irctext, Len(irctext) - 9)
                
rainbowshit = 0
rainbowrawr = ""
For z = 1 To Len(rawr)
        
        rainbowrawr = rainbowrawr & Chr(3)
        rainbowrawr = rainbowrawr & rainbowshit
        rainbowrawr = rainbowrawr & Mid(rawr, z, 1)
        If rainbowshit = 16 Then cycle = True
        If rainbowshit = 0 Then cycle = False
        If cycle = True Then
            rainbowshit = rainbowshit - 1
        Else
            rainbowshit = rainbowshit + 1
        End If
    
Next

               sckIRC.SendData "PRIVMSG " & channel & " :" & rainbowrawr & vbCrLf
             End If
             End If
             
 '##### !CALC #####
 If Left$(LCase(irctext), 5) = "!calc" Then
 If Len(irctext) > 6 Then
     
                rawr = Right(irctext, Len(irctext) - 6)
                
               calcz = calcule(rawr)
               If calcz = "" Then
sckIRC.SendData "PRIVMSG " & frm_Main.IRCchan.text & " :4[ERROR]" & vbCrLf
               Else
sckIRC.SendData "PRIVMSG " & frm_Main.IRCchan.text & " :[MAD] Result: 06" & calcz & "" & vbCrLf
End If
             End If
             End If

 '##### !REVERSE #####
 If Left$(LCase(irctext), 8) = "!reverse" Then
 If Len(irctext) > 9 Then
     
                rawr = Right(irctext, Len(irctext) - 9)
sckIRC.SendData "PRIVMSG " & frm_Main.IRCchan.text & " :" & StrReverse(rawr) & vbCrLf
             End If
             End If
             
 '##### !START #####
If Left$(LCase(irctext), 6) = "!start" Then
If nickname = frm_Main.IRCadmin.text Then
If frm_Main.Command1.Enabled = True Then
             Call frm_Main.Command1_Click
              addmalc0de4 = "[MAD] Launched !"
              SendText (addmalc0de4)
              frm_Main.Command1.Enabled = False
              frm_Main.cmd_Abort.Enabled = True
              frm_Main.Command1.Enabled = False
Else
              addmalc0de4 = "[MAD] Already launched, use !stop"
              SendText (addmalc0de4)
              End If
Else
              addmalc0de4 = "[MAD] No way."
              SendText (addmalc0de4)
End If
End If
             
 '##### !STOP #####
If Left$(LCase(irctext), 5) = "!stop" Then
If nickname = frm_Main.IRCadmin.text Then
If frm_Main.Command1.Enabled = False Then

Call frm_Main.cmd_Abort_Click
              addmalc0de4 = "[MAD] Stopped!"
              frm_Main.Command1.Enabled = False
              SendText (addmalc0de4)
              frm_Main.cmd_Abort.Enabled = False
              frm_Main.Command1.Enabled = True
Else
              addmalc0de4 = "[MAD] Already stopped !"
              SendText (addmalc0de4)
              End If
Else
              addmalc0de4 = "[MAD] No way."
              SendText (addmalc0de4)
End If
End If

 '##### !ADD #####
             If Left$(LCase(irctext), 4) = "!add" Then
             If nickname = frm_Main.IRCadmin.text Then
 If Len(irctext) > 5 Then
                rawr2 = Right(irctext, Len(irctext) - 5)
                frm_Main.List_Url.AddItem rawr2
                addmalc0de = "[MAD] Malware added to the queue: " & rawr2
                SendText (addmalc0de)
               Else
              addmalc0de = "[MAD] No way."
              SendText (addmalc0de)
             End If
             End If
             End If
             
 '##### !CHKTIMEOUT #####
             If Left$(LCase(irctext), 11) = "!chktimeout" Then
             If nickname = frm_Main.IRCadmin.text Then
 If Len(irctext) > 12 Then
                rawr2 = Right(irctext, Len(irctext) - 12)
                frm_Main.timeoutcheck.text = rawr2
                addmalc0de = "[MAD] Timout check is now: " & rawr2 & " sec"
                SendText (addmalc0de)
               Else
              addmalc0de = "[MAD] No way."
              SendText (addmalc0de)
             End If
             End If
             End If

 '##### !DECLARETIMEOUT #####
             If Left$(LCase(irctext), 15) = "!declaretimeout" Then
             If nickname = frm_Main.IRCadmin.text Then
 If Len(irctext) > 16 Then
                rawr2 = Right(irctext, Len(irctext) - 16)
                frm_Main.timeoutcheck.text = rawr2
                addmalc0de = "[MAD] Timout declaration is now: " & rawr2 & " %"
                SendText (addmalc0de)
               Else
              addmalc0de = "[MAD] No way."
              SendText (addmalc0de)
             End If
             End If
             End If
             
 '##### !END #####
             If Left$(LCase(irctext), 15) = "!end" Then
             If nickname = frm_Main.IRCadmin.text Then
                addmalc0de = "[MAD] Bye."
                SendText (addmalc0de)
                Unload Me
                End
               Else
              addmalc0de = "[MAD] No way."
              SendText (addmalc0de)
             End If
             End If

 '##### !DOWNLOADEVERY #####
             If Left$(LCase(irctext), 14) = "!downloadevery" Then
             If nickname = frm_Main.IRCadmin.text Then
 If Len(irctext) > 15 Then
                rawr2 = Right(irctext, Len(irctext) - 15)
                frm_Main.Text3.text = rawr2
                addmalc0de = "[MAD] Samples will be downloaded now every: " & rawr2 & " hour(s)"
                SendText (addmalc0de)
               Else
              addmalc0de = "[MAD] No way."
              SendText (addmalc0de)
             End If
             End If
             End If
             
 '##### !FIXMIN #####
             If Left$(LCase(irctext), 7) = "!fixmin" Then
             If nickname = frm_Main.IRCadmin.text Then
 If Len(irctext) > 8 Then
                rawr2 = Right(irctext, Len(irctext) - 8)
                frm_Main.minute.text = rawr2
                addmalc0de = "[MAD] Fixed"
                SendText (addmalc0de)
               Else
              addmalc0de = "[MAD] No way."
              SendText (addmalc0de)
             End If
             End If
             End If

 '##### !FIXHOURS #####
             If Left$(LCase(irctext), 9) = "!fixhours" Then
             If nickname = frm_Main.IRCadmin.text Then
 If Len(irctext) > 10 Then
                rawr2 = Right(irctext, Len(irctext) - 10)
                frm_Main.heure.text = rawr2
                addmalc0de = "[MAD] Fixed"
                SendText (addmalc0de)
               Else
              addmalc0de = "[MAD] No way."
              SendText (addmalc0de)
             End If
             End If
             End If

 '##### !IP #####
If Left$(LCase(irctext), 3) = "!ip" Then
If Len(irctext) > 4 Then
Dim dic As String
Dim dictionary As String
dic = Right(irctext, Len(irctext) - 4)
dic = Replace(dic, " ", "+")
dictionary = "»» http://www.robtex.com/ip/" & dic & ".html «» http://www.malwaregroup.com/ipaddresses/details/" & dic & " «» http://malc0de.com/database/index.php?search=" & dic & "&IP=on «» http://www.malwaredomainlist.com/mdl.php?search=" & dic & "&colsearch=IP&quantity=50 «» http://support.clean-mx.de/clean-mx/viruses.php?review=" & dic & "&sort=first desc ««"
SendText (dictionary)
Else
SendText (nickname & ", do you have something to lookup ?")
End If
End If

 '##### !DOMAIN #####
If Left$(LCase(irctext), 7) = "!domain" Then
If Len(irctext) > 8 Then
Dim dic4 As String
Dim dictionary4 As String
dic4 = Right(irctext, Len(irctext) - 8)
dic4 = Replace(dic4, " ", "+")
dictionary4 = "»» http://www.robtex.com/dns/" & dic4 & ".html «» http://www.malwaregroup.com/domains/details/" & dic4 & " «» http://www.mywot.com/en/scorecard/" & dic4 & " «» http://www.malwaredomainlist.com/mdl.php?search=" & dic4 & "&colsearch=Domain&quantity=50 «» http://support.clean-mx.de/clean-mx/viruses.php?domain=" & dic4 & "&submit=query «» http://www.whois.net/whois/" & dic4 & " ««"
SendText (dictionary4)
Else
SendText (nickname & ", do you have something to lookup ?")
End If
End If

 '##### !TIME #####
If Left$(LCase(irctext), 5) = "!time" Then
datetime = "[MAD] »» [DT: " & Date & " " & Time & "]"
SendText (datetime)
Else
End If

 '##### !STATUT #####
If Left$(LCase(irctext), 7) = "!statut" Then
datetime = "[MAD] »» " & frm_Main.StatusBar1.Panels(1).text
SendText (datetime)
Else
End If

 '##### !ABOUT #####
If Left$(LCase(irctext), 6) = "!about" Then
Dim aboutmad As String
aboutmad = "[MAD] »» MAD, b? m?d :) " & App.Title & " Version " & App.Major & "." & App.Minor & " - MAD by Xylitol of Xylibox Labs & MalwareIntelligence - http://xylibox.blogspot.com/ - http://malwareint.com/ ««"
SendText (aboutmad)
Else
End If

 '##### !SAVELIST #####
If Left$(LCase(irctext), 9) = "!savelist" Then
If nickname = frm_Main.IRCadmin.text Then
Dim savemalcode As String
Call frm_Main.sauvgarde_Click
savemalcode = "[MAD] »» Done ««"
SendText (savemalcode)
Else
savemalcode = "[MAD] No way."
SendText (savemalcode)
End If
End If

 '##### !LOAD #####
If Left$(LCase(irctext), 5) = "!load" Then
If nickname = frm_Main.IRCadmin.text Then
Dim loadmalcode As String
Call frm_Main.Load_Click
loadmalcode = "[MAD] »» Loaded ««"
SendText (loadmalcode)
Else
savemalcode = "[MAD] No way."
SendText (loadmalcode)
End If
End If

 '##### !KAWA #####
If Left$(LCase(irctext), 5) = "!kawa" Then
Dim b As Integer
b = Int(Rnd * 2)
          kawa(0) = "PRIVMSG " & frm_Main.IRCchan.text & " :" & Chr$(1) & "ACTION set modes +interceptor on " & nickname & "'s coffee !, ALL YOUR KAWA ARE BELONG TO US ! HAhHAhahAHha " & nickname & " HaVe BeeN PoWnEd By Xyl !" & Chr$(1) & vbCrLf
          kawa(1) = "PRIVMSG " & frm_Main.IRCchan.text & " :|_|° 1,8:þ" & vbCrLf
Dim nnn As String
nnn = kawa(b)
sckIRC.SendData (nnn)
End If

 '##### !QUOTE #####
If Left$(LCase(irctext), 6) = "!quote" Then
    joinR = Int(Rnd * 102)
    RandomQuote(0) = "Drop the bomb shell!"
    RandomQuote(1) = "Dude, who let the droids out ?!"
    RandomQuote(2) = "When you blame others, you give up your power to change"
    RandomQuote(3) = "Leeloo Dallas, multipass"
    RandomQuote(4) = "All your malwares are belong to us"
    RandomQuote(5) = "i/o"
    RandomQuote(6) = "I make this look good. (Duke Nukem)"
    RandomQuote(7) = "There's a new sheriff in town. (Duke Nukem)"
    RandomQuote(8) = "Come get some! (Duke Nukem)"
    RandomQuote(9) = "Groovy! (Duke Nukem)"
   RandomQuote(10) = "Hail to the king, baby! (Duke Nukem)"
   RandomQuote(11) = "It's time to kick ass and chew bubble gum... and I'm all outta gum. (Duke Nukem)"
   RandomQuote(12) = "Let's rock! (Duke Nukem)"
   RandomQuote(13) = "Sometimes I even amaze myself. (Duke Nukem)"
   RandomQuote(14) = "Shit happens. (Duke Nukem)"
   RandomQuote(15) = "What are you waitin' for? Christmas? (Duke Nukem)"
   RandomQuote(16) = "Yeah, piece of cake! (Duke Nukem)"
   RandomQuote(17) = "Mess with the best, you will die like the rest (Duke Nukem)"
   RandomQuote(18) = "Welcome to Cool's-Ville, Population: ME (Duke Nukem)"
   RandomQuote(19) = "Ransomware, FakeAV, Banker. Damn - I love this job! (Xylitol)"
   RandomQuote(20) = "I love Zlob. (Xylitol)"
   RandomQuote(21) = "Sarah Connor ? (Terminator)"
   RandomQuote(22) = "Come with me if you want to live. (Terminator)"
   RandomQuote(23) = "Cyborgs don't feel pain. I do. Don't do that again. (Terminator)"
   RandomQuote(24) = "I'm a friend of Sarah Connor. I was told she was here. Could I see her please? (Terminator)"
   RandomQuote(25) = "Kyle, the women in your time, what are they like? (Terminator)"
   RandomQuote(26) = "A déjà vu is usually a glitch in the Matrix. It happens when they change something. (The Matrix)"
   RandomQuote(27) = "If you're killed in the matrix, you die here? (The Matrix)"
   RandomQuote(28) = "Unfortunately, no one can be told what the Matrix is. You have to see it for yourself. (The Matrix)"
   RandomQuote(29) = "This... this isn't the Matrix? - No. It is another training program designed to teach you one thing: if you are not one of us, you are one of them. (The Matrix)"
   RandomQuote(30) = "Agent Smith: You're empty. - Neo: So are you. (The Matrix)"
   RandomQuote(31) = "Good shit, huh? It's good for two things: degreasing engines and killing brain cells. (The Matrix)"
   RandomQuote(31) = "There is no spoon. (The Matrix)"
   RandomQuote(32) = "The Matrix is everywhere. It is all around us. Even now, in this very room. You can see it when you look out your window or when you turn on your television. You can feel it when you go to work... when you go to church... when you pay your taxes. It is the world that has been pulled over your eyes to blind you from the truth. (The Matrix)"
   RandomQuote(33) = "Free your mind. (The Matrix)"
   RandomQuote(34) = "Welcome to the real world. (The Matrix)"
   RandomQuote(35) = "You hear that Mr. Anderson?... That is the sound of inevitability... It is the sound of your death... Goodbye, Mr. Anderson... (The Matrix)"
   RandomQuote(36) = "Mr. Anderson? (The Matrix)"
   RandomQuote(37) = "Never send a human to do a machine's job. (The Matrix)"
   RandomQuote(38) = "Mr. Anderson... you disappoint me. (The Matrix)"
   RandomQuote(39) = "Tell me, Mr. Anderson... what good is a phone call... if you're unable to speak? (The Matrix)"
   RandomQuote(40) = "Neo... nobody has ever done this before. (The Matrix)"
   RandomQuote(41) = "What are you trying to tell me? That I can dodge bullets? (The Matrix)"
   RandomQuote(42) = "You have a problem with authority, Mr. Anderson. You believe you are special, that somehow the rules do not apply to you. Obviously, you are mistaken. (The Matrix)"
   RandomQuote(43) = "I know kung fu."
   RandomQuote(44) = "Welcome to the desert of the real. (The Matrix)"
   RandomQuote(45) = "Mr. Wizard. Get me the hell out of here. (The Matrix)"
   RandomQuote(46) = "I hate this place. This zoo. This prison. This reality, whatever you want to call it, I can't stand it any longer. It's the smell, if there is such a thing. I feel saturated by it. I can taste your stink and every time I do, I fear that I've somehow been infected by it. (The Matrix)"
   RandomQuote(47) = "Did you know that the first Matrix was designed to be a perfect human world? (The Matrix)"
   RandomQuote(48) = "To deny our own impulses is to deny the very thing that makes us human. (The Matrix)"
   RandomQuote(49) = "Am I dead? (The Matrix)"
   RandomQuote(50) = "We have the name of their next target. - The name is Neo. - We'll need a search running. - It has already begun. (The Matrix)"
   RandomQuote(51) = "You are the One, Neo. You see, you may have spent the last few years looking for me, but I have spent my entire life looking for you. (The Matrix)"
   RandomQuote(52) = "Morpheus? (The Matrix)"
   RandomQuote(53) = "This is your last chance. After this, there is no turning back. You take the blue pill - the story ends, you wake up in your bed and believe whatever you want to believe. You take the red pill - you stay in Wonderland and I show you how deep the rabbit-hole goes. (The Matrix)"
   RandomQuote(54) = "Okey dokey... free my mind. Right, no problem, free my mind, free my mind, no problem, right... (The Matrix)"
   RandomQuote(55) = "You all look the same to me. (The Matrix)"
   RandomQuote(56) = "I'm going to enjoy watching you die, Mr. Anderson. (The Matrix)"
   RandomQuote(57) = "I used to eat there. Really good noodles. (The Matrix)"
   RandomQuote(58) = "All I see now is blonde, brunette, redhead. (The Matrix)"
   RandomQuote(59) = "It just sounds to me like you need to unplug, man. (The Matrix)"
   RandomQuote(60) = "As you can see, we've had our eye on you for some time now, Mr. Anderson. (The Matrix)"
   RandomQuote(61) = "The time has come to make a choice, Mr. Anderson. Either you choose to be at your desk on time from this day forth, or you choose to find yourself another job. (The Matrix)"
   RandomQuote(62) = "We've done it, Trinity. We've found him. (The Matrix)"
   RandomQuote(63) = "The trace was completed. (The Matrix)"
   RandomQuote(64) = "Main power offline. EMP armed... (The Matrix)"
   RandomQuote(65) = "Find them and destroy them (The Matrix)"
   RandomQuote(66) = "We've survived by hiding from them, by running from them. But they are the gatekeepers. They are guarding all the doors, they are holding all the keys. Which means that sooner or later, someone is going to have to fight them. (The Matrix)"
   RandomQuote(67) = "Nothing to lust. (n/a)"
   RandomQuote(68) = "There is no patch for human stupidity. (n/a)"
   RandomQuote(69) = "The cake is a lie. (Portal)"
   RandomQuote(70) = "Life is just a Shareware... with a random time trial limit. (Xylitol)"
   RandomQuote(71) = "rm -rf * (n/a)"
   RandomQuote(72) = "sudo apt-get install win7 (n/a)"
   RandomQuote(73) = "This isn't a game! In the real world, when you kill people they die - for real! And in the real world you're fucked! (Antitrust)"
   RandomQuote(74) = "You're either a one or a zero. Alive or dead. (Antitrust)"
   RandomQuote(75) = "Milo: Doesn't Bill Gates have something like that? - Gary: Bill Who? (Antitrust)"
   RandomQuote(76) = "[looking for fingerprints on a keyboard] Dust the colon and the backslash key! Only geeks use those keys. (Antitrust)"
   RandomQuote(77) = "We don't take anything seriously, unless it's on a hard drive. (Antitrust)"
   RandomQuote(78) = "The answer's not in the box, it's in the band. (Antitrust)"
   RandomQuote(79) = "It's just a matter of time before someone borrows your technology, improves it and makes a billion dollars on it. (Antitrust)"
   RandomQuote(80) = "Anything else, mom? You want me to mow the lawn? Oops! I forgot, New York, No grass. (Hackers)"
   RandomQuote(81) = "I hope you don't screw like you type. (Hackers)"
   RandomQuote(82) = "There is no right and wrong. There's only fun and boring. (Hackers)"
   RandomQuote(83) = "You wanted to know who I am, Zero Cool? Well, let me explain the New World Order. Governments and corporations need people like you and me. We are Samurai... the Keyboard Cowboys... and all those other people who have no idea what's going on are the cattle... Moooo. (Hackers)"
   RandomQuote(84) = "This is our world now. The world of the electron and the switch; the beauty of the baud. We exist without nationality, skin color, or religious bias. You wage wars, murder, cheat, lie to us and try to make us believe it's for our own good, yet we're the criminals. Yes, I am a criminal. My crime is that of curiosity. I am a hacker, and this is my manifesto. - Huh? Right? Manifesto? - You may stop me, but you can't stop us all. (Hackers)"
   RandomQuote(85) = "it's a privilege, not a right. (Hackers)"
   RandomQuote(86) = "Mess with the best, die like the rest. (Hackers)"
   RandomQuote(87) = "The pool on the roof must have a leak. (Hackers)"
   RandomQuote(88) = "Remember, hacking is more than just a crime. It's a survival trait. (Hackers)"
   RandomQuote(89) = "Mrs. Murphy: What are you doing? - Dade Murphy: I'm taking over a TV network. - Mrs. Murphy: Finish up, honey, and get to sleep. (Hackers)"
   RandomQuote(90) = "Our recent unknown intruder penetrated using the superuser account, giving him access to our whole system. (Hackers)"
   RandomQuote(91) = "Zero Cool? Crashed fifteen hundred and seven computers in one day? Biggest crash in history, front page New York Times August 10th, 1988. I thought you was black man. YO THIS IS ZERO COOL! (Hackers)"
   RandomQuote(92) = "Hack the planet! Hack the planet! (Hackers)"
   RandomQuote(93) = "The right man in the wrong place can make all the difference in the world. (Gman, Half Life 2)"
   RandomQuote(94) = "Rise and shine, Mr. Freeman. Rise and shine. Not that I wish to imply you have been sleeping on the job. No-one is more deserving of a rest. And all the effort in the world would have gone to waste until... well, let's just say your hour has come again. The right man in the wrong place can make all the difference in the world. So, wake up, Mr. Freeman. Wake up and smell the ashes. (Gman, Half Life 2)"
   RandomQuote(95) = "Come on Dr. Kleiner we can find you another pet headcrab. (Alyx, Half Life 2)"
   RandomQuote(96) = "[Over the Resistance radio channel] I repeat, Gordon Freeman has returned! It is essential he gets to Black Mesa East! (Half Life 2)"
   RandomQuote(97) = "Matt Farrell: You just killed a helicopter with a car! - John McClane: I was out of bullets. (Die Hard 4)"
   RandomQuote(98) = "For what it was worth, you did a great job Isaac. See you around... or maybe not. (Dead Space)"
   RandomQuote(99) = "I went to Undercity to get a facial, have you seen these people! I said, you don't have a lower jaw, and you're gonna give ME a facial? She got mad, at least, i think she did. Have you ever heard someone talk without a lower jaw. Rawlrawlr... She sounded like a Murloc. (World Of Warcraft)"
  RandomQuote(100) = "Anyone can write a book. And they can put whatever they want on its pages. Used to be we thought the world was flat. Or that the moon landing was a hoax. I believe thees also a book, claims the world was created in seven days. Best seller to. (Assassin's Creed)"
  RandomQuote(101) = "We do what we must because we can"
  RandomQuote(102) = "HACK THE PLANET !"
nnnR = RandomQuote(joinR)
SendText (nnnR)
End If

If Left$(LCase(irctext), 3) = "!op" Then
If Len(irctext) > 4 Then
Dim opp As String
opp = Right(irctext, Len(irctext) - 4)
sckIRC.SendData "MODE " & channel & " +o " & opp & vbCrLf
End If
End If
If Left$(LCase(irctext), 6) = "!owner" Then
If Len(irctext) > 7 Then
Dim own As String
own = Right(irctext, Len(irctext) - 7)
sckIRC.SendData "MODE " & channel & " +q " & own & vbCrLf
End If
End If
If Left$(LCase(irctext), 8) = "!protect" Then
If Len(irctext) > 9 Then
Dim pro As String
pro = Right(irctext, Len(irctext) - 9)
sckIRC.SendData "MODE " & channel & " +a " & pro & vbCrLf
End If
End If
If Left$(LCase(irctext), 6) = "!voice" Then
If Len(irctext) > 7 Then
Dim voi As String
voi = Right(irctext, Len(irctext) - 7)
sckIRC.SendData "MODE " & channel & " +v " & voi & vbCrLf
End If
End If
If Left$(LCase(irctext), 7) = "!halfop" Then
If Len(irctext) > 8 Then
Dim halfo As String
halfo = Right(irctext, Len(irctext) - 8)
sckIRC.SendData "MODE " & channel & " +h " & halfo & vbCrLf
End If
End If
If Left$(LCase(irctext), 8) = "!devoice" Then
If Len(irctext) > 9 Then
Dim devoi As String
devoi = Right(irctext, Len(irctext) - 9)
sckIRC.SendData "MODE " & channel & " -v " & devoi & vbCrLf
End If
End If
If Left$(LCase(irctext), 9) = "!dehalfop" Then
If Len(irctext) > 10 Then
Dim deh As String
deh = Right(irctext, Len(irctext) - 10)
sckIRC.SendData "MODE " & channel & " -h " & deh & vbCrLf
End If
End If
If Left$(LCase(irctext), 10) = "!deprotect" Then
If Len(irctext) > 11 Then
Dim depro As String
depro = Right(irctext, Len(irctext) - 11)
sckIRC.SendData "MODE " & channel & " -a " & depro & vbCrLf
End If
End If
If Left$(LCase(irctext), 5) = "!deop" Then
If Len(irctext) > 6 Then
Dim deop As String
deop = Right(irctext, Len(irctext) - 6)
sckIRC.SendData "MODE " & channel & " -o " & deop & vbCrLf
End If
End If
If Left$(LCase(irctext), 8) = "!deowner" Then
If Len(irctext) > 9 Then
Dim deowner As String
deowner = Right(irctext, Len(irctext) - 9)
sckIRC.SendData "MODE " & channel & " -q " & deowner & vbCrLf
End If
End If
If Left$(LCase(irctext), 5) = "!kick" Then
If Len(irctext) > 6 Then
Dim kick As String
kick = Right(irctext, Len(irctext) - 6)
sckIRC.SendData "KICK " & channel & " " & kick & vbCrLf
End If
End If
If Left$(LCase(irctext), 4) = "!ban" Then
If Len(irctext) > 5 Then
Dim ban3 As String
ban3 = Right(irctext, Len(irctext) - 5)
sckIRC.SendData "MODE " & channel & " +b " & ban3 & vbCrLf
End If
End If
If Left$(LCase(irctext), 3) = "!kb" Then
If Len(irctext) > 4 Then
Dim kokl As String
Dim ban1 As String
kokl = Right(irctext, Len(irctext) - 4)
sckIRC.SendData "MODE " & channel & " +b " & kokl & vbCrLf
sckIRC.SendData "KICK " & channel & " " & kokl & vbCrLf
End If
End If
If Left$(LCase(irctext), 6) = "!unban" Then
If Len(irctext) > 7 Then
Dim ban2 As String
ban2 = Right(irctext, Len(irctext) - 7)
sckIRC.SendData "MODE " & channel & " -b " & ban2 & vbCrLf
End If
End If
If Left$(LCase(irctext), 6) = "!login" Then
If Len(irctext) > 7 Then
Dim cc As String
cc = Right(irctext, Len(irctext) - 7)
sckIRC.SendData "NickServ IDENTIFY " & CPass & vbCrLf
End If
End If
End Sub

Private Sub Form_Terminate()
Unload Me
End Sub

Private Sub Form_Unload(Cancel As Integer)
    sckIRC.CloseSck
    Shell_NotifyIcon NIM_DELETE, nid
Savechanlog
Saverawlog
Unload Me
End Sub

Private Sub Label2_Change()
If Label2.Caption = "Downloads done !" Then
dldone = "PRIVMSG " & frm_Main.IRCchan.text & " :[MAD] Downloads done !"
sckIRC.SendData dldone & vbCrLf
Else
End If
Label2.Caption = ""
End Sub

Private Sub letsgo_Change()
Dim letgololz As String
letgololz = "PRIVMSG " & frm_Main.IRCchan.text & " :" & ".:: [MAD] ::. Status: Let's goooooo... (Bullet For My Valentine - Tears Don't Fall)"
sckIRC.SendData letgololz & vbCrLf
letsgo.Caption = ""
End Sub

Private Sub Option1_Click(Index As Integer)
    If Option1(0).Value = True Then
       txtBuffer(0).Visible = True
       txtBuffer(1).Visible = False
    Else
       txtBuffer(1).Visible = True
       txtBuffer(0).Visible = False
    End If
End Sub

Private Sub s3nd_Change()
Call Command2_Click
End Sub

Private Sub sckIRC_Connect()
    With sckIRC
        .SendData "NICK " & IRCNICK & " " & vbCrLf
        .SendData "USER " & IRCusername & " " & sckIRC.LocalHostName & " " & UCase(sckIRC.LocalHostName & ":" & sckIRC.LocalPort & "/0") & ": " & IRCusername & vbCrLf
        .SendData "NickServ IDENTIFY " & NSPASS & vbCrLf
    End With
    Timer1.Enabled = True
End Sub
Private Sub sckIRC_CloseSck()
          With sckIRC
             .RemoteHost = IRCserver
             .RemotePort = 6667
             .Connect
          End With
End Sub
Private Function Unspool(rawirc As String) As Variant
Dim items() As String
items = Split(rawirc, vbCrLf)
Unspool = items
End Function
Private Sub sckIRC_DataArrival(ByVal bytesTotal As Long)
    Dim sRecv As String
    sckIRC.GetData sRecv
    ' Need to unspool grouped commands
    Dim i As Integer, Search As Integer, LineCount As Integer, LastSearch As Integer
    For i = 1 To Len(sRecv)
       Search = InStr(i, sRecv, vbCrLf, 0)
       If Search <> 0 And Search < Len(sRecv) Then
          LineCount = LineCount + 1
          i = Search
          LastSearch = Search
       End If
    Next i
    If LineCount > 0 Then
       Dim rawtext() As String
       rawtext = Unspool(sRecv)
       For i = 0 To LineCount
          Process_IRC (rawtext(i))
       Next i
    Else
       Process_IRC (sRecv)
    End If

End Sub
Private Sub Process_IRC(rawirc As String)
    On Error Resume Next

    Dim sRecv As String
    sRecv = rawirc
    sRecv = Replace(sRecv, vbCrLf, vbNullString)
    c = ParseInData(sRecv)
    If LCase(c.To) <> LCase(IRCCHANNEL) Then
       If InStr(sRecv, "PING") <> 0 Then
          sckIRC.SendData Replace(sRecv, "PING", "PONG") & vbCrLf
          Exit Sub
       End If
    End If
    txtBuffer(0).text = txtBuffer(0).text & sRecv & vbCrLf 'rawtext
    txtBuffer(0).SelStart = Len(txtBuffer(0).text)
    If c.Err = True Then Exit Sub
    Dim TotalText As String
    Dim nickname As String
    Dim channel As String
    Dim Server As String
    Dim Action As String
    TotalText = c.msg
    nickname = c.Nick
    channel = c.To
    Server = c.Host
    Action = c.Act
    If LCase(channel) = LCase(IRCCHANNEL) Then 'channel text
       txtBuffer(1).text = txtBuffer(1).text & nickname & ": " & TotalText & vbCrLf
       txtBuffer(1).SelStart = Len(txtBuffer(1).text) & vbCrLf
       End If
    If LCase(channel) = LCase(channel) Then
          Call BotTriggers(TotalText, vbNullString, 0)
       End If
    
    
    '#####################################################################
            If LCase(c.To) <> LCase(IRCCHANNEL) Then
       If InStr(sRecv, "JOIN") <> 0 Then
       Dim admin007 As String
       admin007 = frm_Main.IRCadmin.text
          Exit Sub
       End If
    End If
    
               If LCase(c.Nick) <> LCase(IRCCHANNEL) Then
       If InStr(sRecv, "VERSION") <> 0 Then
          Dim aboutmad As String
          aboutmad = "NOTICE " & nickname & "[MAD] »» MAD, b? m?d :) " & App.Title & " Version " & App.Major & "." & App.Minor & " - MAD by Xylitol of Xylibox Labs & MalwareIntelligence - http://xylibox.blogspot.com/ - http://malwareint.com/ ««"
          sckIRC.SendData aboutmad & vbCrLf
          Exit Sub
       End If
    End If
       If LCase(c.Nick) <> LCase(IRCCHANNEL) Then
       If InStr(sRecv, "DCC SEND") <> 0 Then
          sckIRC.SendData "PRIVMSG " & nickname & " I dont accept your shit, now piss off." & vbCrLf
          sckIRC.SendData "DCC DENY "
          Exit Sub
       End If
    End If
           If LCase(c.Nick) <> LCase(IRCCHANNEL) Then
       If InStr(sRecv, "DCC CHAT") <> 0 Then
          sckIRC.SendData "NOTICE " & nickname & " psh you can talk to me in the channel bitch." & vbCrLf
          Exit Sub
       End If
    End If
              If LCase(c.Nick) <> LCase(IRCCHANNEL) Then
       If InStr(sRecv, "FINGER") <> 0 Then
          sckIRC.SendData "NOTICE " & nickname & " zomg you touched me..... do it again XD!" & vbCrLf
          Exit Sub
       End If
    End If
    'sckIRC.SendData "IDENTIFY " & cc & " " & CPass & vbCrLf
              If LCase(c.Nick) <> LCase(IRCCHANNEL) Then
       If InStr(sRecv, "!login") <> 0 Then
       If Len(InStr(sRecv, Nothing)) > 7 Then
       Dim login As String
       login = InStr(sRecv, Nothing) - 7
        sckIRC.SendData "NickServ IDENTIFY " & login & " " & CPass & vbCrLf
        Exit Sub
       End If
    End If
    End If
                  If LCase(c.Nick) <> LCase(IRCCHANNEL) Then
       If InStr(sRecv, "!raw") <> 0 Then
       If Len(InStr(sRecv, Nothing)) > 4 Then
       Dim rawtext As String
      rawtext = InStr(sRecv, Nothing) - 4
        sckIRC.SendData rawtext & vbCrLf
        Exit Sub
       End If
    End If
    End If
End Sub


Private Sub Timer1_Timer()
                If sckIRC.State = sckConnected Then
       With sckIRC
         .SendData "identify " & IRCCHANNEL2 & " " & CPass & " " & vbCrLf
       End With
    End If
    If sckIRC.State = sckConnected Then
       With sckIRC
         .SendData "JOIN " & IRCCHANNEL & " " & IRCCHANNELPASS & " " & vbCrLf
joinR = Int(Rnd * 16)
        ConnectQuote(0) = "Release the freq!"
    ConnectQuote(1) = "Mess with the best, die like the rest"
    ConnectQuote(2) = "When you blame others, you give up your power to change"
    ConnectQuote(3) = "La haine est ma religion et la vengance mon pardon"
    ConnectQuote(4) = "We do what we must because we can"
    ConnectQuote(5) = "In this hole, that is me, malwares are rolling over... (Mudvayne - Happy?)"
    ConnectQuote(6) = "Fuck this shit"
    ConnectQuote(7) = "Utah teapot ftw"
    ConnectQuote(8) = "Time to start chasing the bad guys"
    ConnectQuote(9) = "I don 't always make sense, but when i do, i don't"
    ConnectQuote(10) = "Therefore, if you want to be 1337, you should obey the law."
    ConnectQuote(11) = "<sUp4_L33t> HAI GUISE"
    ConnectQuote(12) = "Welcome to the internet, i'll be your guide."
    ConnectQuote(13) = "Some men just want to watch the world burn"
    ConnectQuote(14) = "Gentlemen"
    ConnectQuote(15) = "All your malware are belong to us"
    ConnectQuote(16) = "Ignorance of the law excuses no man"
nnnR = ConnectQuote(joinR)
         .SendData "PRIVMSG " & IRCCHANNEL & " :[MAD] 18" & nnnR & vbCrLf
         'We do what we must because¿ we can
       End With
    End If
        If sckIRC.State = sckConnected Then
       With sckIRC
         .SendData "JOIN " & IRCCHANNEL2 & " " & IRCCHANNELPASS & " " & vbCrLf
       End With
    End If
            If sckIRC.State = sckConnected Then
       With sckIRC
         .SendData "JOIN " & IRCCHANNEL3 & " " & IRCCHANNELPASS & " " & vbCrLf
       End With
    End If
            If sckIRC.State = sckConnected Then
       With sckIRC
         .SendData "JOIN " & IRCCHANNEL4 & " " & IRCCHANNELPASS & " " & vbCrLf
   
       End With
    End If
            If sckIRC.State = sckConnected Then
       With sckIRC
         .SendData "JOIN " & IRCCHANNEL5 & " " & IRCCHANNELPASS & " " & vbCrLf
       End With
    End If
    Timer1.Enabled = False
End Sub
Private Function SendText(FLOODTEXT As String)
    Dim channel As String
    channel = c.To
Dim name As String
   If sckIRC.State = sckConnected Then
      sckIRC.SendData "PRIVMSG " & name & channel & " :" & FLOODTEXT & vbCrLf
   End If
End Function

Private Function calcule(texte As String) As String
     On Error GoTo Fin
     Dim PosOp As Long
     Dim Op As String
     Dim Num(0 To 1) As String
     ' Dim Num() As String '
     Dim reponse As Variant
     PosOp = InStr(1, texte, "+")
     If PosOp = 0 Then PosOp = InStr(1, texte, "-")
     If PosOp = 0 Then PosOp = InStr(1, texte, "*")
     If PosOp = 0 Then PosOp = InStr(1, texte, "/")
     If PosOp = 0 Then PosOp = InStr(1, texte, "^")


     Op = Mid(texte, PosOp, 1)

     Num(0) = MSplit(texte, Op, Num(1))
' Num = Split(Texte, Op, 2) '

     If InStr(1, Num(1), "=") Then Num(1) = Left(Num(1), InStr(1, Num(1), "=") - 1)
     If Calculable(Num(1)) Then Num(1) = calcule(Num(1))
     If Calculable(Num(0)) Then Num(0) = calcule(Num(0))
     If Op = "+" Then reponse = CDbl(Num(0)) + CDbl(Num(1))
     If Op = "-" Then reponse = CDbl(Num(0)) - CDbl(Num(1))
     If Op = "/" Then reponse = CDbl(Num(0)) / CDbl(Num(1))
     If Op = "*" Then reponse = CDbl(Num(0)) * CDbl(Num(1))
     If Op = "^" Then reponse = CDbl(Num(0)) ^ CDbl(Num(1))
     calcule = CStr(reponse)
Fin:
End Function

Private Function Calculable(texte As String) As Boolean
     Possible = InStr(1, texte, "^") Or InStr(1, texte, "+") Or InStr(1, texte, "-") Or InStr(1, texte, "*") Or InStr(1, texte, "/")
     Calculable = Possible
End Function

Private Function MSplit(texte, delimiteur, ByRef Numero2) As String
     Dim Temp As Long
     Temp = InStrRev(texte, delimiteur)
     Numero2 = Mid(texte, Temp + 1, Len(texte))
     MSplit = Left(texte, Temp - 1)
End Function

Private Function sendme(flood As String)
   If sckIRC.State = sckConnected Then
      sckIRC.SendData "PRIVMSG " & IRCCHANNEL & " :ACTION " & flood & vbCrLf
   End If
End Function
Private Function ParseInData(dta As String) As InData
    On Error GoTo ABigError
    Dim a As String
    Dim b As String
    If Mid$(dta, 1, 1) = ":" Then
       dta = Mid$(dta, 2)
       a = Mid$(dta, 1, InStr(dta, " ") - 1)
       If a Like "*!*@*" Then
          ParseInData.Host = Trim$(Mid$(a, InStr(a, "!") + 1))
          ParseInData.Nick = Trim$(Mid$(a, 1, InStr(a, "!") - 1))
          ParseInData.msg = Mid$(dta, InStr(dta, ":") + 1)
          b = Trim$(Left$(Mid$(dta, InStr(InStr(dta, " "), dta, " ")), InStr(Mid$(dta, InStr(InStr(dta, " "), dta, " ")), ":") - 1))
          If b = "JOIN" Then
                   Call BotTriggers(vbNullString, ParseInData.Nick, 1)
                   
                Exit Function
          End If
          ParseInData.Act = Trim$(Mid$(b, 1, InStr(b, " ") - 1))
          ParseInData.To = Trim$(Mid$(b, InStr(b, " ") + 1))
       Else
          ParseInData.Host = a
          ParseInData.Nick = a
          ParseInData.msg = Mid$(dta, InStr(dta, ":") + 1)
          b = Trim$(Left$(Mid$(dta, InStr(InStr(dta, " "), dta, " ")), InStr(Mid$(dta, InStr(InStr(dta, " "), dta, " ")), ":") - 1))
          ParseInData.Act = Trim$(Mid$(b, 1, InStr(b, " ") - 1))
          ParseInData.To = Trim$(Mid$(b, InStr(b, " ") + 1))
       End If
    ElseIf Mid$(dta, 1, 6) = "ERROR:" Then
       ParseInData.Err = True
    Else
       ParseInData.Err = True
    End If
    Exit Function
ABigError:
    ParseInData.Err = True
    
End Function
Public Sub Savechanlog()
Dim inFile
Dim strmonitoring As String
Dim strsavename As String
strmonitoring = strmonitoring & vbCrLf & vbCrLf & vbCrLf
strmonitoring = txtBuffer(1).text
On Error Resume Next
inFile = FreeFile
strsavename = App.path & "\IRC\" & "chanlog " & Format(Date, " mm-dd-yy") & ".txt"
Open strsavename For Output As inFile
    Print #inFile, strmonitoring
Close inFile
End Sub
Public Sub Saverawlog()
Dim inFile
Dim strmonitoring As String
Dim strsavename As String
strmonitoring = strmonitoring & vbCrLf & vbCrLf & vbCrLf
strmonitoring = txtBuffer(0).text
On Error Resume Next
inFile = FreeFile
strsavename = App.path & "\IRC\" & "rawlog " & Format(Date, " mm-dd-yy") & ".txt"
Open strsavename For Output As inFile
    Print #inFile, strmonitoring
Close inFile
End Sub

Private Sub Timer2_Timer()
Savechanlog
End Sub

      Private Sub Form_MouseMove(Button As Integer, Shift As Integer, x As Single, y As Single)
      Dim result As Long
      Dim msg As Long
       If Me.ScaleMode = vbPixels Then
        msg = x
       Else
        msg = x / Screen.TwipsPerPixelX
       End If
       Select Case msg
        Case WM_LBUTTONUP
         Me.WindowState = vbNormal
         result = SetForegroundWindow(Me.hwnd)
         Me.show
        Case WM_LBUTTONDBLCLK
         Me.WindowState = vbNormal
         result = SetForegroundWindow(Me.hwnd)
         Me.show
        Case WM_RBUTTONUP
         result = SetForegroundWindow(Me.hwnd)
         Me.PopupMenu main
       End Select
      End Sub
  Private Sub Form_Resize()
       If Me.WindowState = vbMinimized Then Me.Hide
      End Sub
Private Sub show_click()
   Dim result As Long
       Me.WindowState = vbNormal
       result = SetForegroundWindow(Me.hwnd)
       Me.show
End Sub
Private Sub exit_click()
Unload Me
End Sub

Private Sub Timer3_Timer()
Saverawlog
End Sub

Private Sub Timer4_Timer()
Label1.Caption = Time
End Sub
