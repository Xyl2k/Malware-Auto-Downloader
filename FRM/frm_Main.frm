VERSION 5.00
Object = "{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}#1.1#0"; "shdocvw.dll"
Object = "{831FDD16-0C5C-11D2-A9FC-0000F8754DA1}#2.0#0"; "Mscomctl.ocx"
Object = "{248DD890-BB45-11CF-9ABC-0080C7E7B78D}#1.0#0"; "Mswinsck.ocx"
Begin VB.Form frm_Main 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Malware Auto-Downloader v1.7 - xylitol@malwareint.com"
   ClientHeight    =   4770
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   8370
   Icon            =   "frm_Main.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   ScaleHeight     =   4770
   ScaleWidth      =   8370
   StartUpPosition =   2  'CenterScreen
   Visible         =   0   'False
   Begin VB.TextBox startupbox 
      Height          =   285
      Left            =   9120
      TabIndex        =   137
      Top             =   3720
      Width           =   2055
   End
   Begin VB.TextBox Text11 
      Height          =   285
      Left            =   9120
      TabIndex        =   136
      Top             =   7320
      Width           =   2415
   End
   Begin VB.TextBox ADMINPHPfinal 
      Height          =   2415
      Left            =   7920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   124
      Top             =   9360
      Visible         =   0   'False
      Width           =   4215
   End
   Begin VB.TextBox randomname 
      Height          =   285
      Left            =   7560
      TabIndex        =   121
      Text            =   "randomname"
      Top             =   8760
      Visible         =   0   'False
      Width           =   3495
   End
   Begin VB.PictureBox Picture1 
      Height          =   5535
      Left            =   120
      ScaleHeight     =   5475
      ScaleWidth      =   8055
      TabIndex        =   43
      Top             =   5280
      Visible         =   0   'False
      Width           =   8110
      Begin VB.TextBox RandomAdmiName 
         Alignment       =   1  'Right Justify
         Height          =   285
         Left            =   2280
         TabIndex        =   122
         Text            =   "admin"
         Top             =   3840
         Width           =   2895
      End
      Begin VB.CommandButton Command21 
         Caption         =   "Generate name"
         Height          =   255
         Left            =   5760
         TabIndex        =   116
         Top             =   3840
         Width           =   1935
      End
      Begin VB.CommandButton Command12 
         Caption         =   "Open WWW folder"
         Height          =   375
         Left            =   360
         TabIndex        =   63
         Top             =   2640
         Width           =   7335
      End
      Begin VB.CommandButton Command11 
         Caption         =   "Back"
         Height          =   375
         Left            =   6120
         TabIndex        =   62
         Top             =   4920
         Width           =   1575
      End
      Begin VB.CommandButton Command8 
         Caption         =   "Build the  PHP Malware Monitoring Center"
         Height          =   375
         Left            =   360
         TabIndex        =   56
         Top             =   2160
         Width           =   7335
      End
      Begin VB.Frame Frame4 
         Caption         =   "Protected update page/Admin password"
         Height          =   1935
         Left            =   4080
         TabIndex        =   53
         Top             =   120
         Width           =   3615
         Begin VB.TextBox Text10 
            Height          =   285
            Left            =   960
            TabIndex        =   54
            Top             =   840
            Width           =   2295
         End
         Begin VB.Label Label31 
            Height          =   255
            Left            =   120
            TabIndex        =   118
            Top             =   1200
            Width           =   2895
         End
         Begin VB.Label Label12 
            Alignment       =   1  'Right Justify
            Caption         =   "Password:"
            Height          =   255
            Left            =   120
            TabIndex        =   55
            Top             =   840
            Width           =   735
         End
      End
      Begin VB.Frame Frame3 
         Caption         =   "MySQL"
         Height          =   1935
         Left            =   360
         TabIndex        =   44
         Top             =   120
         Width           =   3615
         Begin VB.TextBox Text9 
            Height          =   285
            Left            =   1080
            TabIndex        =   52
            Top             =   1440
            Width           =   2295
         End
         Begin VB.TextBox Text8 
            Height          =   285
            Left            =   1080
            TabIndex        =   51
            Top             =   1080
            Width           =   2295
         End
         Begin VB.TextBox Text7 
            Height          =   285
            Left            =   1080
            TabIndex        =   50
            Text            =   "root"
            Top             =   720
            Width           =   2295
         End
         Begin VB.TextBox Text6 
            Height          =   285
            Left            =   1080
            TabIndex        =   45
            Text            =   "localhost"
            Top             =   360
            Width           =   2295
         End
         Begin VB.Label Label16 
            Alignment       =   1  'Right Justify
            Caption         =   "Database:"
            Height          =   255
            Left            =   120
            TabIndex        =   49
            Top             =   1440
            Width           =   855
         End
         Begin VB.Label Label15 
            Alignment       =   1  'Right Justify
            Caption         =   "Password:"
            Height          =   255
            Left            =   120
            TabIndex        =   48
            Top             =   1080
            Width           =   855
         End
         Begin VB.Label Label14 
            Alignment       =   1  'Right Justify
            Caption         =   "User:"
            Height          =   255
            Left            =   120
            TabIndex        =   47
            Top             =   720
            Width           =   855
         End
         Begin VB.Label Label13 
            Alignment       =   1  'Right Justify
            Caption         =   "Host:"
            Height          =   255
            Left            =   120
            TabIndex        =   46
            Top             =   360
            Width           =   855
         End
      End
      Begin VB.Label Label35 
         Caption         =   ".php"
         Height          =   255
         Left            =   5280
         TabIndex        =   125
         Top             =   3840
         Width           =   495
      End
      Begin VB.Label Label34 
         Caption         =   "Otherwise leave the field or enter the name manually: only letters (a-z) and numbers (0-9) please."
         Height          =   255
         Left            =   360
         TabIndex        =   123
         Top             =   3600
         Width           =   7575
      End
      Begin VB.Label Label33 
         Caption         =   "name"
         Height          =   255
         Left            =   3840
         TabIndex        =   120
         Top             =   3120
         Width           =   4095
      End
      Begin VB.Label Label32 
         Caption         =   "random"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   -1  'True
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000C0&
         Height          =   255
         Left            =   3120
         TabIndex        =   119
         Top             =   3120
         Width           =   4815
      End
      Begin VB.Label Label30 
         Caption         =   "If you want also use a random name for your admin PHP page, you can press Generate (recommended)"
         Height          =   495
         Left            =   360
         TabIndex        =   117
         Top             =   3360
         Width           =   7575
      End
      Begin VB.Label Label29 
         Caption         =   "Read help.chm or press F1 for see the help."
         Height          =   255
         Left            =   360
         TabIndex        =   115
         Top             =   4560
         Width           =   7335
      End
      Begin VB.Label Label27 
         Caption         =   "Upload the whole WWW folder to your server and import db.sql in your database."
         Height          =   255
         Left            =   360
         TabIndex        =   114
         Top             =   4320
         Width           =   7335
      End
      Begin VB.Label Label17 
         Caption         =   "The Update page is generated with a"
         ForeColor       =   &H00000000&
         Height          =   255
         Left            =   360
         TabIndex        =   57
         Top             =   3120
         Width           =   7575
      End
   End
   Begin VB.TextBox SQLdb 
      Height          =   2415
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   61
      Text            =   "frm_Main.frx":E4F5
      Top             =   1800
      Visible         =   0   'False
      Width           =   4215
   End
   Begin VB.TextBox captchaPHP 
      Height          =   2415
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   112
      Text            =   "frm_Main.frx":E651
      Top             =   1560
      Visible         =   0   'False
      Width           =   4215
   End
   Begin VB.TextBox captchaftcPHP 
      Height          =   2415
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   111
      Text            =   "frm_Main.frx":E817
      Top             =   1320
      Visible         =   0   'False
      Width           =   4215
   End
   Begin MSComctlLib.StatusBar StatusBar1 
      Align           =   2  'Align Bottom
      Height          =   255
      Left            =   0
      TabIndex        =   2
      Top             =   4515
      Width           =   8370
      _ExtentX        =   14764
      _ExtentY        =   450
      _Version        =   393216
      BeginProperty Panels {8E3867A5-8586-11D1-B16A-00C0F0283628} 
         NumPanels       =   1
         BeginProperty Panel1 {8E3867AB-8586-11D1-B16A-00C0F0283628} 
            Object.Width           =   17637
            MinWidth        =   17637
         EndProperty
      EndProperty
   End
   Begin VB.TextBox ind3xPHP 
      Height          =   2415
      Left            =   10920
      Locked          =   -1  'True
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   58
      Text            =   "frm_Main.frx":F6EB
      Top             =   1080
      Visible         =   0   'False
      Width           =   4215
   End
   Begin VB.TextBox GetPHP 
      Height          =   2415
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   60
      Text            =   "frm_Main.frx":10128
      Top             =   840
      Visible         =   0   'False
      Width           =   4215
   End
   Begin VB.TextBox configPHP 
      Height          =   2415
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   92
      Text            =   "frm_Main.frx":10378
      Top             =   600
      Visible         =   0   'False
      Width           =   4215
   End
   Begin VB.TextBox ADMINPHP 
      Height          =   2415
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   93
      Text            =   "frm_Main.frx":1050B
      Top             =   360
      Visible         =   0   'False
      Width           =   4215
   End
   Begin VB.TextBox infoPHP 
      Height          =   2415
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   96
      Text            =   "frm_Main.frx":123E0
      Top             =   120
      Visible         =   0   'False
      Width           =   4215
   End
   Begin VB.PictureBox Picture3 
      Height          =   2415
      Left            =   240
      ScaleHeight     =   2355
      ScaleWidth      =   5715
      TabIndex        =   97
      Top             =   360
      Visible         =   0   'False
      Width           =   5775
      Begin VB.CheckBox Check3 
         Caption         =   "Start with Windows"
         Height          =   255
         Left            =   120
         TabIndex        =   135
         Top             =   1560
         Width           =   2295
      End
      Begin VB.CheckBox PEinfoCheck 
         Caption         =   "Enable PE infos analyzes (Warning: download only *.dll, *.exe with MAD!)"
         Height          =   255
         Left            =   120
         TabIndex        =   113
         Top             =   1320
         Width           =   6855
      End
      Begin VB.CheckBox connectstartup 
         Caption         =   "Connect the IRC bot when the program is launched (recommended)"
         Height          =   255
         Left            =   120
         TabIndex        =   108
         Top             =   1080
         Width           =   5535
      End
      Begin VB.TextBox timeoutcheck 
         Alignment       =   2  'Center
         Height          =   285
         Left            =   2760
         MaxLength       =   2
         TabIndex        =   100
         Text            =   "15"
         Top             =   240
         Width           =   495
      End
      Begin VB.TextBox Text13 
         Alignment       =   2  'Center
         Height          =   285
         Left            =   3720
         MaxLength       =   2
         TabIndex        =   99
         Text            =   "30"
         Top             =   600
         Width           =   495
      End
      Begin VB.CommandButton Command19 
         Caption         =   "Apply change(s)"
         Height          =   375
         Left            =   120
         TabIndex        =   98
         Top             =   1920
         Width           =   5415
      End
      Begin VB.Label Label28 
         Caption         =   "%"
         Height          =   255
         Left            =   4320
         TabIndex        =   107
         Top             =   600
         Width           =   375
      End
      Begin VB.Label Label19 
         Caption         =   "Timeout check if we have reached:"
         Height          =   255
         Left            =   120
         TabIndex        =   103
         Top             =   240
         Width           =   2775
      End
      Begin VB.Label Label25 
         Caption         =   "second(s) in a file"
         Height          =   255
         Left            =   3360
         TabIndex        =   102
         Top             =   240
         Width           =   2175
      End
      Begin VB.Label Label26 
         Caption         =   "And declared timeout if the progress bar is under:"
         Height          =   255
         Left            =   120
         TabIndex        =   101
         Top             =   600
         Width           =   4095
      End
   End
   Begin VB.PictureBox Picture2 
      Height          =   4215
      Left            =   120
      ScaleHeight     =   4155
      ScaleWidth      =   8055
      TabIndex        =   72
      Top             =   5280
      Visible         =   0   'False
      Width           =   8110
      Begin VB.CommandButton Command14 
         Caption         =   "Back"
         Height          =   615
         Left            =   6120
         TabIndex        =   83
         Top             =   3240
         Width           =   1575
      End
      Begin VB.CommandButton Command13 
         Caption         =   "Start the bot"
         Height          =   615
         Left            =   360
         TabIndex        =   82
         Top             =   3240
         Width           =   5655
      End
      Begin VB.Frame IRCframe 
         Caption         =   "IRC Configuration"
         Height          =   2655
         Left            =   360
         TabIndex        =   73
         Top             =   360
         Width           =   7335
         Begin VB.TextBox IRCusername 
            Height          =   285
            Left            =   2520
            TabIndex        =   131
            Top             =   1440
            Width           =   3375
         End
         Begin VB.TextBox IRCadmin 
            Height          =   285
            Left            =   2520
            TabIndex        =   128
            Top             =   2160
            Width           =   4335
         End
         Begin VB.TextBox IRCpasswordChan 
            Height          =   285
            Left            =   5760
            TabIndex        =   126
            Top             =   720
            Width           =   1095
         End
         Begin VB.TextBox IRCnickserv 
            Height          =   285
            Left            =   2520
            TabIndex        =   85
            Top             =   1800
            Width           =   4335
         End
         Begin VB.TextBox IRCchan 
            Height          =   285
            Left            =   2520
            TabIndex        =   77
            Top             =   720
            Width           =   2295
         End
         Begin VB.TextBox IRCpseudo 
            Height          =   285
            Left            =   2520
            TabIndex        =   76
            Text            =   "Yoda"
            Top             =   1080
            Width           =   4335
         End
         Begin VB.TextBox IRCserver 
            Height          =   285
            Left            =   2520
            TabIndex        =   75
            Top             =   360
            Width           =   3015
         End
         Begin VB.TextBox IRCport 
            Height          =   285
            Left            =   5760
            TabIndex        =   74
            Text            =   "6667"
            Top             =   360
            Width           =   1095
         End
         Begin VB.Label Label40 
            Alignment       =   1  'Right Justify
            Caption         =   "Bot username"
            Height          =   255
            Left            =   240
            TabIndex        =   133
            Top             =   1440
            Width           =   2175
         End
         Begin VB.Label Label39 
            Alignment       =   1  'Right Justify
            Caption         =   "@MAD.MAD"
            Height          =   255
            Left            =   5640
            TabIndex        =   132
            Top             =   1440
            Width           =   1215
         End
         Begin VB.Label Label38 
            Alignment       =   1  'Right Justify
            Caption         =   "Bot Auth (NickServ)"
            Height          =   255
            Left            =   360
            TabIndex        =   130
            Top             =   1800
            Width           =   2055
         End
         Begin VB.Label Label37 
            Alignment       =   1  'Right Justify
            Caption         =   "Bot owner (Admin)"
            Height          =   255
            Left            =   360
            TabIndex        =   129
            Top             =   2160
            Width           =   2055
         End
         Begin VB.Label Label36 
            Caption         =   "password:"
            Height          =   255
            Left            =   4920
            TabIndex        =   127
            Top             =   720
            Width           =   855
         End
         Begin VB.Label Label24 
            Alignment       =   1  'Right Justify
            Caption         =   "Bot nick"
            Height          =   255
            Left            =   120
            TabIndex        =   81
            Top             =   1080
            Width           =   2295
         End
         Begin VB.Label Label23 
            Alignment       =   1  'Right Justify
            Caption         =   "Server : port"
            Height          =   255
            Left            =   120
            TabIndex        =   80
            Top             =   360
            Width           =   2295
         End
         Begin VB.Label Label22 
            Caption         =   " :"
            Height          =   255
            Left            =   5520
            TabIndex        =   79
            Top             =   360
            Width           =   135
         End
         Begin VB.Label Label21 
            Alignment       =   1  'Right Justify
            Caption         =   "Chan"
            Height          =   255
            Left            =   120
            TabIndex        =   78
            Top             =   720
            Width           =   2295
         End
      End
   End
   Begin VB.CommandButton Command10 
      Caption         =   "Config"
      Height          =   255
      Left            =   5040
      TabIndex        =   66
      Top             =   5760
      Width           =   1455
   End
   Begin VB.CommandButton Command9 
      Caption         =   "Help !"
      Height          =   255
      Left            =   6600
      TabIndex        =   65
      Top             =   5760
      Width           =   1455
   End
   Begin VB.CommandButton Thanks 
      Caption         =   "About..."
      Height          =   255
      Left            =   6120
      TabIndex        =   26
      Top             =   2520
      Width           =   1935
   End
   Begin VB.CommandButton cmd_Abort 
      Caption         =   "Cancel"
      Enabled         =   0   'False
      Height          =   375
      Left            =   6120
      TabIndex        =   27
      Top             =   2160
      Width           =   1935
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Download"
      Height          =   375
      Left            =   6120
      TabIndex        =   28
      Top             =   1800
      Width           =   1935
   End
   Begin VB.CommandButton Command15 
      Caption         =   "D"
      Height          =   255
      Left            =   7800
      TabIndex        =   91
      Top             =   1560
      Width           =   255
   End
   Begin VB.CommandButton Command4 
      Caption         =   "Open Malware folder"
      Height          =   255
      Left            =   6120
      TabIndex        =   29
      Top             =   1560
      Width           =   1695
   End
   Begin VB.CommandButton Command16 
      Caption         =   "D"
      Height          =   255
      Left            =   7800
      TabIndex        =   94
      Top             =   1320
      Width           =   255
   End
   Begin VB.CommandButton Command3 
      Caption         =   "Open Information.txt"
      Height          =   255
      Left            =   6120
      TabIndex        =   30
      Top             =   1320
      Width           =   1695
   End
   Begin VB.CommandButton Command17 
      Caption         =   "D"
      Height          =   255
      Left            =   7800
      TabIndex        =   95
      Top             =   1080
      Width           =   255
   End
   Begin VB.CommandButton Command2 
      Caption         =   "Open malcode.txt"
      Height          =   255
      Left            =   6120
      TabIndex        =   31
      Top             =   1080
      Width           =   1695
   End
   Begin VB.CommandButton sauvgarde 
      Caption         =   "Save"
      Height          =   255
      Left            =   7080
      TabIndex        =   32
      Top             =   840
      Width           =   975
   End
   Begin VB.CommandButton Load 
      Caption         =   "Load"
      Height          =   255
      Left            =   6120
      TabIndex        =   33
      Top             =   840
      Width           =   975
   End
   Begin VB.CommandButton Remove 
      Caption         =   "Remove"
      Height          =   255
      Left            =   7080
      TabIndex        =   34
      Top             =   600
      Width           =   975
   End
   Begin VB.CommandButton add 
      Caption         =   "Add"
      Height          =   255
      Left            =   6120
      TabIndex        =   35
      Top             =   600
      Width           =   975
   End
   Begin VB.TextBox txt 
      Height          =   2415
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   3  'Both
      TabIndex        =   89
      Top             =   8400
      Width           =   4215
   End
   Begin VB.CommandButton GEtPEinfos 
      Caption         =   "PE infos"
      Height          =   255
      Left            =   9360
      TabIndex        =   88
      Top             =   3240
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox MalwarePE 
      Height          =   285
      Left            =   9120
      TabIndex        =   87
      Text            =   "Text13"
      Top             =   6000
      Width           =   3735
   End
   Begin VB.TextBox malwareirc 
      Height          =   285
      Left            =   9120
      TabIndex        =   84
      Text            =   "malwareirc"
      Top             =   6360
      Visible         =   0   'False
      Width           =   3735
   End
   Begin VB.Timer Timer3 
      Enabled         =   0   'False
      Interval        =   2000
      Left            =   6360
      Top             =   7080
   End
   Begin VB.CommandButton Command6 
      Caption         =   "<< PHP Website support ?"
      Height          =   255
      Left            =   5640
      TabIndex        =   68
      Top             =   3480
      Visible         =   0   'False
      Width           =   2415
   End
   Begin VB.CommandButton Command7 
      Caption         =   ">> PHP Website support ?"
      Height          =   255
      Left            =   5640
      TabIndex        =   67
      Top             =   3480
      Width           =   2415
   End
   Begin VB.CheckBox Check2 
      Caption         =   "IRC bot ?"
      Height          =   255
      Left            =   4320
      TabIndex        =   70
      Top             =   3480
      Width           =   1095
   End
   Begin VB.CommandButton IRC 
      Caption         =   "Config"
      Height          =   255
      Left            =   3360
      TabIndex        =   69
      Top             =   3480
      Width           =   855
   End
   Begin VB.TextBox Text12 
      Height          =   1575
      Left            =   10920
      MultiLine       =   -1  'True
      ScrollBars      =   2  'Vertical
      TabIndex        =   59
      Top             =   4320
      Visible         =   0   'False
      Width           =   1935
   End
   Begin VB.CommandButton Command5 
      Height          =   255
      Left            =   9360
      TabIndex        =   36
      Top             =   4680
      Width           =   1455
   End
   Begin VB.TextBox UrlToDownload 
      Height          =   285
      Left            =   8640
      Locked          =   -1  'True
      TabIndex        =   22
      Top             =   2880
      Visible         =   0   'False
      Width           =   2175
   End
   Begin VB.CommandButton md5 
      Caption         =   "md5"
      Height          =   255
      Left            =   9360
      TabIndex        =   16
      Top             =   4320
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.TextBox Text4 
      Height          =   285
      Left            =   8760
      TabIndex        =   15
      Top             =   5040
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.TextBox seconde 
      Height          =   285
      Left            =   11280
      TabIndex        =   11
      Text            =   "0"
      Top             =   6720
      Width           =   735
   End
   Begin VB.TextBox minute 
      Height          =   285
      Left            =   10200
      TabIndex        =   10
      Text            =   "0"
      Top             =   6720
      Width           =   975
   End
   Begin VB.TextBox heure 
      Height          =   285
      Left            =   9120
      TabIndex        =   9
      Text            =   "0"
      Top             =   6720
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Left            =   8760
      TabIndex        =   6
      Top             =   5400
      Visible         =   0   'False
      Width           =   2055
   End
   Begin MSWinsockLib.Winsock Socket 
      Left            =   7440
      Top             =   3000
      _ExtentX        =   741
      _ExtentY        =   741
      _Version        =   393216
   End
   Begin VB.Frame Frame2 
      Height          =   4215
      Left            =   120
      TabIndex        =   3
      Top             =   120
      Width           =   8110
      Begin VB.CommandButton Command18 
         Caption         =   "Options"
         Height          =   255
         Left            =   6960
         TabIndex        =   104
         Top             =   240
         Width           =   975
      End
      Begin VB.CheckBox Check1 
         Caption         =   "Activate ?"
         Height          =   255
         Left            =   240
         TabIndex        =   41
         Top             =   6240
         Width           =   4575
      End
      Begin VB.TextBox Text5 
         ForeColor       =   &H00000000&
         Height          =   285
         Left            =   1920
         TabIndex        =   40
         Text            =   "http://localhost/MAD/Get.php"
         Top             =   6960
         Width           =   6015
      End
      Begin VB.TextBox Text2 
         Height          =   285
         Left            =   1920
         TabIndex        =   37
         Top             =   6600
         Width           =   6015
      End
      Begin VB.Timer Timer1 
         Enabled         =   0   'False
         Interval        =   1000
         Left            =   6840
         Top             =   2880
      End
      Begin VB.ListBox List_Url 
         Height          =   2400
         ItemData        =   "frm_Main.frx":1252B
         Left            =   120
         List            =   "frm_Main.frx":1252D
         TabIndex        =   19
         Top             =   240
         Width           =   5775
      End
      Begin VB.Timer Timer2 
         Enabled         =   0   'False
         Interval        =   15000
         Left            =   6360
         Top             =   2880
      End
      Begin VB.TextBox Text3 
         Alignment       =   2  'Center
         Height          =   285
         Left            =   2040
         MaxLength       =   1
         TabIndex        =   14
         Text            =   "1"
         Top             =   3360
         Width           =   375
      End
      Begin MSComctlLib.ProgressBar PB 
         Height          =   255
         Left            =   240
         TabIndex        =   8
         Top             =   3840
         Width           =   7695
         _ExtentX        =   13573
         _ExtentY        =   450
         _Version        =   393216
         Appearance      =   1
      End
      Begin VB.Label Label11 
         Alignment       =   1  'Right Justify
         Caption         =   "PHP update page:"
         Height          =   255
         Left            =   120
         TabIndex        =   39
         Top             =   6960
         Width           =   1695
      End
      Begin VB.Label Label10 
         Alignment       =   1  'Right Justify
         Caption         =   "Password Protection:"
         Height          =   255
         Left            =   120
         TabIndex        =   38
         Top             =   6600
         Width           =   1695
      End
      Begin VB.Label Label9 
         Caption         =   "n/a"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   255
         Left            =   1200
         TabIndex        =   24
         Top             =   3000
         Width           =   6735
      End
      Begin VB.Label Label8 
         Caption         =   "n/a"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00808080&
         Height          =   255
         Left            =   1200
         TabIndex        =   23
         Top             =   2760
         Width           =   6735
      End
      Begin VB.Label SampleNumber 
         Alignment       =   2  'Center
         Caption         =   "[0/0]"
         Height          =   255
         Left            =   6000
         TabIndex        =   17
         Top             =   240
         Width           =   975
      End
      Begin VB.Label Label6 
         Caption         =   "hour(s)"
         Height          =   255
         Left            =   2520
         TabIndex        =   13
         Top             =   3360
         Width           =   735
      End
      Begin VB.Label Label5 
         Caption         =   "Download sample every:"
         Height          =   255
         Left            =   240
         TabIndex        =   12
         Top             =   3360
         Width           =   2175
      End
      Begin VB.Line Line1 
         BorderColor     =   &H00FFFFFF&
         X1              =   240
         X2              =   7920
         Y1              =   3720
         Y2              =   3720
      End
      Begin VB.Line Line2 
         BorderColor     =   &H00808080&
         BorderWidth     =   2
         X1              =   240
         X2              =   7920
         Y1              =   3720
         Y2              =   3720
      End
      Begin VB.Label Label3 
         Alignment       =   1  'Right Justify
         Caption         =   "Latest saved:"
         Height          =   255
         Left            =   120
         TabIndex        =   7
         Top             =   3000
         Width           =   975
      End
      Begin VB.Label Label4 
         Alignment       =   1  'Right Justify
         Caption         =   "Processing:"
         Height          =   255
         Left            =   120
         TabIndex        =   4
         Top             =   2760
         Width           =   975
      End
   End
   Begin VB.Frame Frame1 
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   375
      Left            =   8880
      TabIndex        =   0
      Top             =   7440
      Width           =   1815
      Begin VB.Label lbl_File 
         Height          =   255
         Left            =   2400
         TabIndex        =   5
         Top             =   2040
         Width           =   1455
      End
      Begin VB.Label lbl_CaptionFile 
         Caption         =   "File:"
         Height          =   255
         Left            =   1320
         TabIndex        =   1
         Top             =   2040
         Width           =   1695
      End
   End
   Begin SHDocVwCtl.WebBrowser HoneyPot 
      Height          =   2655
      Left            =   8640
      TabIndex        =   42
      Top             =   120
      Visible         =   0   'False
      Width           =   2160
      ExtentX         =   3810
      ExtentY         =   4683
      ViewMode        =   1
      Offline         =   0
      Silent          =   0
      RegisterAsBrowser=   0
      RegisterAsDropTarget=   0
      AutoArrange     =   -1  'True
      NoClientEdge    =   -1  'True
      AlignLeft       =   0   'False
      NoWebView       =   0   'False
      HideFileNames   =   0   'False
      SingleClick     =   0   'False
      SingleSelection =   0   'False
      NoFolders       =   0   'False
      Transparent     =   0   'False
      ViewID          =   "{0057D0E0-3573-11CF-AE69-08002B2E1262}"
      Location        =   "http:///"
   End
   Begin VB.Label ircform2 
      Caption         =   "Label41"
      Height          =   615
      Left            =   9120
      TabIndex        =   138
      Top             =   3840
      Width           =   1095
   End
   Begin VB.Label Label18 
      Caption         =   "Label18"
      Height          =   255
      Left            =   6360
      TabIndex        =   134
      Top             =   8280
      Width           =   975
   End
   Begin VB.Label lbl_Done 
      Alignment       =   1  'Right Justify
      Caption         =   "0%"
      Height          =   255
      Left            =   9000
      TabIndex        =   110
      Top             =   7080
      Width           =   495
   End
   Begin VB.Label connectvalueirc 
      Height          =   255
      Left            =   13080
      TabIndex        =   109
      Top             =   5880
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.Label progresstimeout 
      Height          =   255
      Left            =   13080
      TabIndex        =   106
      Top             =   6600
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.Label timeeoutcheck 
      Height          =   255
      Left            =   13080
      TabIndex        =   105
      Top             =   6240
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.Label PEinfos 
      Caption         =   "0"
      Height          =   255
      Left            =   13080
      TabIndex        =   90
      Top             =   8040
      Width           =   2055
   End
   Begin VB.Label ircbotlaunchedornot 
      Caption         =   "0"
      Height          =   255
      Left            =   13080
      TabIndex        =   86
      Top             =   7680
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.Label IRCLabel 
      Caption         =   "IRCLabel"
      Height          =   255
      Left            =   13080
      TabIndex        =   71
      Top             =   6960
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.Label Label20 
      Caption         =   "Label20"
      Height          =   255
      Left            =   13080
      TabIndex        =   64
      Top             =   5520
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.Label Label2 
      Caption         =   "D41D8CD98F00B204E9800998ECF8427E.eXe.ViR"
      Height          =   255
      Left            =   13080
      TabIndex        =   25
      Top             =   4440
      Width           =   2055
   End
   Begin VB.Label Label7 
      Height          =   255
      Left            =   13080
      TabIndex        =   21
      Top             =   4680
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.Label Label1 
      Caption         =   "HH-MM-SS-RND.eXe.ViR"
      Height          =   255
      Left            =   13080
      TabIndex        =   20
      Top             =   4920
      Width           =   2055
   End
   Begin VB.Label random 
      Caption         =   "1000"
      Height          =   255
      Left            =   13080
      TabIndex        =   18
      Top             =   5160
      Visible         =   0   'False
      Width           =   2055
   End
   Begin VB.Menu mnuPopup 
      Caption         =   "pop"
      Visible         =   0   'False
      Begin VB.Menu mnu_show 
         Caption         =   "Show"
      End
      Begin VB.Menu mnu_irc 
         Caption         =   "IRC bot panel"
         Enabled         =   0   'False
      End
      Begin VB.Menu mnu_bbq 
         Caption         =   "-"
      End
      Begin VB.Menu mnu_close 
         Caption         =   "Exit"
      End
   End
End
Attribute VB_Name = "frm_Main"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Type tDownload
    strFile As String
    strHost As String
    strPort As String
    strRequest As String
    lngLength As Long
    lngRec As Long
    lngStart As Long
    lngStatusTime As Long
    F As Integer
End Type
Dim Download As tDownload
Dim a As Integer
Dim b As Integer
Dim bbqseconde As Integer
Dim bbqminute As Integer
Dim bbqheure As Integer
Dim reponse As String
Dim ligne As String
Dim Adr As String
Dim PE As New PE
Dim PE1 As New PE
Dim c As New cRegistry
Private WithEvents f_cSystray As cSystray
Attribute f_cSystray.VB_VarHelpID = -1
Private Declare Sub InitCommonControls Lib "Comctl32" ()
Private Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long
Private Declare Function GetPrivateProfileString Lib "kernel32" Alias "GetPrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpDefault As String, ByVal lpReturnedString As String, ByVal nSize As Long, ByVal lpFileName As String) As Long
Private Declare Function WritePrivateProfileString Lib "kernel32" Alias "WritePrivateProfileStringA" (ByVal lpApplicationName As String, ByVal lpKeyName As Any, ByVal lpString As Any, ByVal lpFileName As String) As Long
Option Explicit

'MAD - xylitol@malwareint.com - http://xylibox.blogspot.com/
'Feel free to edit the code and adapt the work
'Really i dont care about open source licenses, do what's you want.
'MAD 1.7...let's get a fucking coffee now.

Private Sub Form_Initialize()
    InitCommonControls
End Sub

Private Sub Form_Load()
MalwarePE.text = "whatever.exe"
Me.Height = 5190
    Randomize
    Picture1.Top = Frame2.Top
    Picture1.Left = Frame2.Left
    Picture2.Top = Frame2.Top
    Picture2.Left = Frame2.Left
    Call startup ' check the reg
    StatusBar1.Panels(1).text = "Check paths..."
If Not rep Then MkDir (App.path & "\Malware")
Open App.path & "\" & "malcode.TxT" For Append As #1 'if not exist that will create the file
Close #1
Open App.path & "\Malware\" & "Information.TxT" For Append As #1
Close #1
If Not Rep2 Then MkDir (App.path & "\WWW")
If Not Rep3 Then MkDir (App.path & "\IRC")
centerform Me 'center the form
a = 0
StatusBar1.Panels(1).text = "Reading: MAD.ini"
Call cdeLecture 'read mad.ini
If Text3.text = "" Then
Text3.text = "1"
Else
End If
If Check2.Value = "1" Then 'IRC bot ?
If connectstartup.Value = "1" Then 'IRC bot at startup?
ircbott.Command3.Caption = "Prepare a message to " & frm_Main.IRCchan.text
Call Command13_Click 'ircbott.show
Else
End If
Else
End If
bbqseconde = 60 'megatimer (cf: Timer1)
bbqminute = 59 'megatimer (cf: Timer1)
bbqheure = Text3.text - 1 'megatimer (cf: Timer1)
    Set f_cSystray = New cSystray
    
    With f_cSystray
        If .IsBalloonCapable Then
            .BalloonIcon = TTIconInfo
            .BalloonText = ""
            .BalloonTitle = "Malware Auto-Downloader " & App.Major & "." & App.Minor
        End If
        .SysTrayIconFromRes "ICON_0"
        .SysTrayToolTip = "Malware Auto-Downloader " & App.Major & "." & App.Minor
        .SysTrayShow True

    End With
StatusBar1.Panels(1).text = "Time to start chasing the bad guys ;)"
frm_Main.show
End Sub

Private Sub Check1_Click()
If Check1.Value = 1 Then
Label20.Caption = 1
Else
Label20.Caption = 0
End If
End Sub

Private Sub Check2_Click() 'IRC bot ?
If Check2.Value = 1 Then
IRC.Enabled = True
mnu_irc.Enabled = True
Else
IRC.Enabled = False
mnu_irc.Enabled = False
End If
End Sub

Public Sub cmd_Abort_Click()
    On Error Resume Next
    Socket.Close
    Close #Download.F
    Timer1.Enabled = False
    bbqseconde = 60
bbqminute = 59
bbqheure = Text3.text
Timer2.Enabled = False
a = 0
    StatusBar1.Panels(1).text = "Status: Canceled"
heure.text = "0"
cmd_Abort.Enabled = False
minute.text = "0"
seconde.text = "0"
Command1.Enabled = True
Text3.Enabled = True
Load.Enabled = True
Remove.Enabled = True
add.Enabled = True
sauvgarde.Enabled = True
Text5.Enabled = True
Text2.Enabled = True
Check1.Enabled = True
Command9.Enabled = True
Command10.Enabled = True
If Fichier_Existe(App.path & "\Malware\" & Label1.Caption) = True Then 'file exist?
Kill App.path & "\Malware\" & Label1.Caption
    Else
    End If
End Sub

Public Sub Command1_Click()
Timer2.Interval = timeoutcheck.text & "000"
If List_Url.ListCount = 0 Then
Exit Sub
End If
If Text3.text = "" Then
MsgBox "Hey enter something...", vbOKOnly + vbExclamation, "Error"
StatusBar1.Panels(1).text = "Download sample every ??"
Else
If Text3.text = "0" Then
MsgBox "wtf ?", vbOKOnly + vbExclamation, "Error"
StatusBar1.Panels(1).text = "Download sample every 0 hour ? wtf"
Else
If Check1.Value = 1 Then
    If Text2.text = "" Then
MsgBox "No password ?" & vbCrLf & "", vbOKOnly + vbExclamation + vbApplicationModal, "MAD"
    Exit Sub
    Else
    If Text5.text = "" Then
MsgBox "url ?" & vbCrLf & "", vbOKOnly + vbExclamation + vbApplicationModal, "MAD"
    Exit Sub
    Else
If Check2.Value = "1" Then
    If ircbotlaunchedornot = "0" Then
       Call Command13_Click 'ircbott.show
        ircbott.Visible = False
        ircbotlaunchedornot.Caption = "0"
    Else
    End If
    Else
    End If
    End If
    End If
    End If
If a = List_Url.ListCount Then 'we have downloaded all the shit?
a = 0
    
StatusBar1.Panels(1).text = "Download(s) done !"
Open App.path & "\Malware\" & "Information.TxT" For Append As #1
Print #1, "DONE! ~ WAITING"
Close #1
Exit Sub
End If
b = a + 1
If a < List_Url.ListCount Then
UrlToDownload.text = List_Url.List(a)
List_Url.Selected(a) = True
a = a + 1
Else
a = 0
Exit Sub
End If
SampleNumber.Caption = "[" & b & "/" & List_Url.ListCount & "]"
PB.Value = "0"
Timer1.Enabled = True
random.Caption = Int(1000 * Rnd)
Text3.Enabled = False
Load.Enabled = False
Remove.Enabled = False
add.Enabled = False
sauvgarde.Enabled = False
Command1.Enabled = False
cmd_Abort.Enabled = True
Text5.Enabled = False
Text2.Enabled = False
Check1.Enabled = False
Command9.Enabled = False
Command10.Enabled = False
    Dim strFile As String
    Dim i As Integer
Dim strnew As String
Text1.text = Time & "-" & random.Caption & ".Temp.ViR" 'random who is not random
strnew = Replace(Text1.text, ":", "-")
Label1.Caption = strnew
PB.Value = 0 'for the fucking hardcoded timeout
lbl_Done.Caption = "0%" 'not used
Adr = UrlToDownload.text
Label7.Caption = RcpNom(Adr)
    On Error Resume Next

        Download.strFile = App.path & "\Malware\" & Label1.Caption
        Download.F = FreeFile
        Open Download.strFile For Binary As #Download.F

        'Start Download
StatusBar1.Panels(1).text = "Downloading: " & UrlToDownload.text

        ParseUrl UrlToDownload, Download.strHost, Download.strPort, Download.strRequest
        If Not Val(Download.strPort) = 0 Then
            'Url is valid download
            Timer2.Enabled = True
            Download.lngRec = 0
            Socket.Close
            Socket.Connect Download.strHost, Download.strPort
            lbl_File.Caption = strFile
        Else
        StatusBar1.Panels(1).text = "DError: The entered URL is not valid"
            MsgBox "Error: The entered URL is not valid", vbOKOnly + vbExclamation, "Error"
        End If
        End If
        End If
End Sub

 Private Sub ChargerProg(CheminProgramme, CheminFichier) 'shell function i'm lazy...
 Shell CheminProgramme & " " & CheminFichier, vbNormalFocus
 End Sub

Private Sub Command10_Click()
Picture1.Visible = True 'show the php malware monitoring center builder
End Sub

Private Sub Command11_Click()
Picture1.Visible = False  'hide the php malware monitoring center builder
End Sub

Private Sub Command12_Click() 'open the www folder in explorer.exe
ChargerProg "explorer", App.path & "\WWW"
End Sub

Private Sub Command13_Click() 'launch irc bot
ircbott.Visible = True
ircbott.Command3.Caption = "Prepare a message to " & frm_Main.IRCchan.text
ircbott.byechan.text = "PART " & frm_Main.IRCchan.text & " :" & " »» MAD v1.7.4 «» Disconnect"
IRCLabel.Caption = "1"
ircbott.show
ircbott.ircstatut.Caption = "1"
Picture2.Visible = False
ircform2.Caption = "1"
End Sub

Private Sub Command14_Click()
Picture2.Visible = False
End Sub

Private Sub Command15_Click()  'kill all .vir ?
Dim n As Long
Dim vbRet As VbMsgBoxResult
Dim rep As String
Dim ext As String
Dim bRet As Boolean

rep = App.path & "\Malware"
ext = ".ViR"
n = CompteFichierReperoire(rep, ext)
If n > 0 Then
vbRet = MsgBox("There is " & n & " file(s) who have the extension " & ext & " in the folder " & rep & vbCrLf & "Do you want to delete all ?", vbQuestion + vbYesNo, "Delete *.ViR")
If vbRet = vbYes Then
bRet = SupprimeFichierReperoire(rep, ext)
MsgBox "Suppression done" & vbCrLf & "", vbOKOnly + vbInformation + vbApplicationModal, "MAD"
Else
MsgBox "Suppression cancelled" & vbCrLf & "", vbOKOnly + vbInformation + vbApplicationModal, "MAD"
End If
Else
MsgBox "No file " & ext & " in the folder " & rep
End If
End Sub

Private Function SupprimeFichierReperoire(path As String, extension As String) As Boolean
Dim fic As String
'kill all .vir ?
fic = Dir$(path & "\*" & extension)
Do While fic <> ""
Kill path & "\" & fic
fic = Dir$
Loop
SupprimeFichierReperoire = True
End Function

Private Function CompteFichierReperoire(ByVal path As String, _
ByVal extension As String) As Long
Dim fic As String
Dim nbFic As Long 'kill all .vir ?

fic = Dir$(path & "\*" & extension)
Do While fic <> ""
nbFic = nbFic + 1
fic = Dir$
Loop
CompteFichierReperoire = nbFic
End Function

Private Sub Command16_Click() 'kill information.txt ?
Dim reponse As VbMsgBoxResult
reponse = MsgBox("Do you want to clear the file information.txt ?", vbYesNo + vbQuestion + vbApplicationModal, "MAD")
Select Case reponse
     Case vbYes
Open App.path & "\Malware\" & "Information.TxT" For Append As #1
Close #1
Kill App.path & "\Malware\" & "Information.TxT"
Open App.path & "\Malware\" & "Information.TxT" For Append As #1
Close #1
     MsgBox "Information.txt: Cleared !", vbOKOnly + vbInformation + vbApplicationModal, "MAD"
     Case vbNo
Exit Sub
End Select
End Sub

Private Sub Command17_Click() 'kill malcode.txt ?
Dim reponse As VbMsgBoxResult
reponse = MsgBox("Do you want to clear the file malcode.txt ?", vbYesNo + vbQuestion + vbApplicationModal, "MAD")
Select Case reponse
     Case vbYes
Open App.path & "\malcode.txt" For Append As #1
Close #1
Kill App.path & "\malcode.txt"
Open App.path & "\malcode.txt" For Append As #1
Close #1
      MsgBox "malcode.txt: Cleared !", vbOKOnly + vbInformation + vbApplicationModal, "MAD"
      Case vbNo
Exit Sub
End Select
End Sub

Private Sub Command18_Click() 'load options
Picture3.Visible = True
Text3.Enabled = False
Load.Enabled = False
Remove.Enabled = False
add.Enabled = False
sauvgarde.Enabled = False
Text5.Enabled = False
Text2.Enabled = False
Check1.Enabled = False
Command9.Enabled = False
Command10.Enabled = False
Command18.Enabled = False
Command6.Enabled = False
Command7.Enabled = False
IRC.Enabled = False
Check2.Enabled = False
End Sub

Private Sub Command19_Click() 'apply options
Timer2.Interval = timeoutcheck.text & "000"
Picture3.Visible = False
Text3.Enabled = True
Load.Enabled = True
Remove.Enabled = True
add.Enabled = True
sauvgarde.Enabled = True
Text5.Enabled = True
Text2.Enabled = True
Check1.Enabled = True
Command9.Enabled = True
Command10.Enabled = True
Command18.Enabled = True
Command6.Enabled = True
Command7.Enabled = True
IRC.Enabled = True
Check2.Enabled = True
End Sub

Private Sub Command2_Click() 'open malcode.txt in notepad
ChargerProg "notepad", App.path & "\" & "malcode.TxT"
End Sub

Private Sub Command3_Click() 'open information.txt in notepad
ChargerProg "notepad", App.path & "\Malware\" & "Information.TxT"
End Sub

Private Sub Command4_Click() 'open the folder with explorer.exe
ChargerProg "explorer", App.path & "\Malware"
End Sub

Private Sub Command6_Click() '<< PHP Website support ? (unshow)
Command6.Visible = False
Command7.Visible = True
Line2.Y1 = 3720
Line1.Y1 = 3720
Line2.Y2 = 3720
Line1.Y2 = 3720
PB.Top = 3840
lbl_Done.Top = 3840
Frame2.Height = 4215
Check1.Top = 5400
Command9.Top = 5400
Command10.Top = 5400
Label10.Top = 5760
Text2.Top = 5760
Text5.Top = 6120
Label11.Top = 6120
Me.Height = 5190
End Sub

Private Sub Command7_Click() '<< PHP Website support ? (show)
Me.Height = 6390
Command7.Visible = False
Command6.Visible = True
Line2.Y1 = 5040
Line1.Y1 = 5040
Line2.Y2 = 5040
Line1.Y2 = 5040
PB.Top = 5160
lbl_Done.Top = 5160
Frame2.Height = 5535
Check1.Top = 3840
Command9.Top = 3840
Command10.Top = 3840
Label10.Top = 4200
Text2.Top = 4200
Text5.Top = 4560
Label11.Top = 4560
End Sub

Private Sub Command8_Click()
If RandomAdmiName.text = "" Then
Exit Sub
Else
End If
Dim n As Long
Dim vbRet As VbMsgBoxResult
Dim rep As String
Dim ext As String
Dim bRet As Boolean
If Not Rep2 Then MkDir (App.path & "\WWW")
rep = App.path & "\WWW"
ext = ".php"
n = CompteFichierReperoire(rep, ext)
If n > 0 Then
bRet = SupprimeFichierReperoire(rep, ext)
Else
End If
Open App.path & "\WWW\" & "db.sql" For Append As #1
Close #1
Kill App.path & "\WWW\" & "db.sql"
RandomFileName 'generate random filename for the update page
Text12.text = configPHP.text
ADMINPHPfinal.text = ADMINPHP.text
Text12 = Replace(Text12, "{HOST}", Text6)
Text12 = Replace(Text12, "{USER}", Text7)
Text12 = Replace(Text12, "{PASSWORD}", Text8)
Text12 = Replace(Text12, "{DATABASE}", Text9)
Text12 = Replace(Text12, "{ADMINPASS}", Text10)
ADMINPHPfinal = Replace(ADMINPHPfinal, "{CUSTOMADMIN}", RandomAdmiName)
ind3xPHP.text = LineTrim(ind3xPHP.text)
Open App.path & "\WWW\" & "index.php" For Append As #1 'if not exist that will create the file
Print #1, ind3xPHP.text;
Close #1
GetPHP.text = LineTrim(GetPHP.text)
Open App.path & "\WWW\" & randomname.text & ".php" For Append As #1
Print #1, GetPHP.text;
Close #1
SQLdb.text = LineTrim(SQLdb.text)
Open App.path & "\WWW\" & "db.sql" For Append As #1
Print #1, SQLdb.text;
Close #1
Text12.text = LineTrim(Text12.text)
Open App.path & "\WWW\" & "config.php" For Append As #1
Print #1, Text12.text;
Close #1
ADMINPHPfinal.text = LineTrim(ADMINPHPfinal.text)
Open App.path & "\WWW\" & RandomAdmiName.text & ".php" For Append As #1
Print #1, ADMINPHPfinal.text;
Close #1
infoPHP.text = LineTrim(infoPHP.text)
Open App.path & "\WWW\" & "infos.php" For Append As #1
Print #1, infoPHP.text;
Close #1
captchaftcPHP.text = LineTrim(captchaftcPHP.text)
Open App.path & "\WWW\" & "captcha.fct.php" For Append As #1
Print #1, captchaftcPHP.text;
Close #1
captchaPHP.text = LineTrim(captchaPHP.text)
Open App.path & "\WWW\" & "captcha.php" For Append As #1
Print #1, captchaPHP.text;
Close #1
MsgBox "Files successfully builded:" & vbCrLf & "- \WWW\db.sql" & vbCrLf & "- \WWW\index.php" & vbCrLf & "- \WWW\config.php" & vbCrLf & "- \WWW\infos.php" & vbCrLf & "- \WWW\captcha.fct.php" & vbCrLf & "- \WWW\captcha.php" & vbCrLf & "--" & vbCrLf & "- \WWW\" & RandomAdmiName.text & ".php (Admin control panel !)" & vbCrLf & "- \WWW\" & randomname.text & ".php (MAD update page !)", vbOKOnly + vbInformation + vbApplicationModal, "Malware Auto-Downloader " & App.Major & "." & App.Minor & " (MAD)"
End Sub

Function LineTrim(ByVal sText As String) As String
    '-- add pre Lf and post Cr
    sText = vbLf & sText & vbCr '<--- unusual characters added
    '-- remove all spaces at the end of lines
    Do While InStr(sText, " " & vbCr)
        sText = Replace(sText, " " & vbCr, vbCr)
    Loop
    '-- remove all multiple CrLf's
    sText = Replace(sText, vbLf & vbCr, "")
    '-- remove first and last added characters
    LineTrim = Mid$(sText, 2, Len(sText) - 2)
End Function

Private Sub Command21_Click()
RandomFileName2
End Sub

Private Function RandomFileName() As String
Const strMaj As String = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
Const strMin As String = "abcdefghijklmnopqrstuvwxyz"
Const strChiffre As String = "0123456789"
Dim strChaineN As String
Randomize
strChaineN = strChaineN & strChiffre & strMin & strMaj
Do Until Len(RandomFileName) >= 12
    RandomFileName = RandomFileName & Mid$(strChaineN, Int((Len(strChaineN) * Rnd) + 1), 1)
Loop
randomname.text = RandomFileName
End Function

Private Function RandomFileName2() As String
Const strMaj As String = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
Const strMin As String = "abcdefghijklmnopqrstuvwxyz"
Const strChiffre As String = "0123456789"
Dim strChaineN As String
Randomize
strChaineN = strChaineN & strChiffre & strMin & strMaj
Do Until Len(RandomFileName2) >= 12
    RandomFileName2 = RandomFileName2 & Mid$(strChaineN, Int((Len(strChaineN) * Rnd) + 1), 1)
Loop
RandomAdmiName.text = RandomFileName2
End Function

Private Sub Command9_Click()
ChargerProg "hh", App.path & "\help.chm"
End Sub

Private Sub connectstartup_Click() 'Connect the IRC bot when the program is launched (recommended)
If connectstartup.Value = "1" Then
connectvalueirc.Caption = "1"
Else
connectvalueirc.Caption = "0"
End If
End Sub

Private Sub connectvalueirc_Change() 'Connect the IRC bot when the program is launched (recommended)
If connectvalueirc.Caption = "1" Then
connectstartup.Value = "1"
Else
connectstartup.Value = "0"
End If
End Sub

Private Sub f_cSystray_MouseUp(Button As Integer)
    f_cSystray.BeforePopup
    PopupMenu mnuPopup
End Sub

Private Sub GEtPEinfos_Click()
txt.text = ""
txt.FontSize = 10
txt.BackColor = RGB(178, 205, 236)

txt.Locked = True
PE.LoadFile MalwarePE.text
PE1.LoadFile MalwarePE.text
'If GetModuleHandle("vba6") <> 0 Then Timer1.Enabled = False
If Err.Description <> "" Then Append Err.Description
Append "=================================================="
Append "<br /><b>Path:</b> %s", PE.FileName
Append "<br />--------------------------------------------------"
Append "<br /><b>PE Magic:</b> %x", PE.DosHeader.Magic
Append "<br /><b>PE PEptr:</b> %x", PE.DosHeader.lFaNew
Append "<br /><b>PE Signature:</b> %x", PE.NTHeader.Signature
Append "<br />--------------------------------------------------------------------------------"
Dim fh As FileHeader
Set fh = PE.NTHeader.FileHeader

'*Optional Header
Dim Opt As OptionalHeader
Set Opt = PE.NTHeader.OptionalHeader
Append "<br /><b>EntryPoint:</b> %x\t<br /><b>ImageBase:</b> %x", Opt.EntryPoint, Opt.ImageBase
Append "<br /><b>Code Base:</b> %x\t<br /><b>Data Base:</b> %x", Opt.CodeBase, Opt.DataBase
Append "<br /><b>File Align:</b> %x \t<br /><b>Section Align:</b> %x", Opt.FileAlignment, Opt.SectionAlignment
Append "<br /><b>Header Size:</b> %x\t<br /><b>Image Size:</b> %x\t<br /><b>Code Size:</b> %x", Opt.HeaderSize, Opt.ImageSize, Opt.CodeSize
Append "<br /><b>CheckSum:</b>  %x\t", Opt.CheckSum
Append "<br />--------------------------------------------------------------------------------"
Append "<br /><b>Time Date Stamp:</b> %x", fh.TimeDateStamp
Append "<br /><b>The File has</b> %d <b>Sections.</b>", fh.NumberOfSections
Append "<br />--------------------------------------------------------------------------------"
Dim tSect As Section
For Each tSect In PE.Sections
    Append "<br /><b>Section Name</b>\t: %s", tSect.name
    Append "<br /><b>Virtual Address</b>\t: %x", tSect.VirtualAddress
    Append "<br /><b>Raw Data Pointer</b>\t: %x", tSect.PointerToRawData
    Append "<br /><b>Raw Data Size</b>\t: %x", tSect.SizeOfRawData
    Append "<br /><b>Characteristics</b>\t: %x", tSect.Characteristics
    Append "<br />--------------------------------------------------"
Next
Dim nPtr As Long
Set tSect = PE.Sections(PE.Sections.Count)
nPtr = tSect.PointerToRawData + tSect.SizeOfRawData
Set tSect = PE1.Sections(1)
tSect.PointerToRawData = nPtr
tSect.name = ".temp"
PE.Sections.add tSect
'PE.SaveFile App.path & "\Temp.exe"
If Err.Description <> "" Then Append "<br /><b>Last Error Encountered: " & Err.Description
Set PE = Nothing
Set PE1 = Nothing
End Sub

Private Sub HoneyPot_NavigateComplete2(ByVal pDisp As Object, URL As Variant)
    Call Command1_Click
End Sub

Private Sub IRC_Click()
If Frame2.Height = 5535 Then
Picture2.Height = 5535
Else
Picture2.Height = 4215
End If
Picture2.Visible = True
End Sub

Private Sub IRCLabel_Change()
If IRCLabel.Caption = "1" Then
StatusBar1.Panels(1).text = "Load the IRC Bot..."
Check2.Value = 1
mnu_irc.Enabled = True
Else
IRCLabel.Caption = "0"
End If
StatusBar1.Panels(1).text = "Time to start chasing the bad guys ;)"
End Sub

Private Sub Label2_Change()
Label9.Caption = Text4.text & "_" & Label7.Caption & ".ViR"
End Sub

Private Sub Label20_Change()
If Label20.Caption = "1" Then
Check1.Value = 1
Else
End If
End Sub

Private Sub malwareirc_Change()
malwareirc = Replace(malwareirc, "http://", "malware://")
End Sub

Private Sub mnu_show_Click()
Me.WindowState = 0
    Me.Visible = True
    Set f_cSystray = Nothing
End Sub

Sub Append(ByVal text As String, ParamArray Vars())
On Error Resume Next
text = Replace(text, "\t", vbTab, , , vbTextCompare)
text = Replace(text, "\n", vbCrLf, , , vbTextCompare)
Dim spt
spt = Split(text, "%")
Dim ub As Long
ub = UBound(spt)
Dim tmp As String
tmp = text
If ub <> 0 Then
    Dim idx As Long
    text = spt(0)
    For idx = 1 To ub
        tmp = ""
        tmp = Vars(idx - 1)
        If tmp <> "" Then
            Select Case UCase(Left(spt(idx), 1))
                Case "X"
                spt(idx) = Hex(tmp) & Mid(spt(idx), 2)
                Case Else
                spt(idx) = tmp & Mid(spt(idx), 2)
            End Select
            text = text & spt(idx)
        End If
    Next
End If
txt.text = txt.text & vbCrLf & text
End Sub

Private Sub mnu_irc_Click()
ircbott.Visible = True
End Sub

Private Sub mnu_close_Click()
Unload frm_Main
End Sub

 Public Sub centerform(frm As Form) 'center form
 frm.Top = Screen.Height / 2 - frm.Height / 2
 frm.Left = Screen.Width / 2 - frm.Width / 2
 End Sub
 
 Function rep() 'rep exist ?
 On Error GoTo Err
 GetAttr App.path & "\Malware"
 rep = True
 Exit Function
Err:
 rep = False
 End Function
 
  Function Rep2() 'rep exist ?
 On Error GoTo Err
 GetAttr App.path & "\WWW"
 Rep2 = True
 Exit Function
Err:
 Rep2 = False
 End Function
 
   Function Rep3() 'rep exist ?
 On Error GoTo Err
 GetAttr App.path & "\IRC"
 Rep3 = True
 Exit Function
Err:
 Rep3 = False
 End Function

Private Function GetFileMD5(ByVal FileName As String) As String
    Dim md5 As New clsMD5, FF As Integer, Buff() As Byte
    Const BuffSize As Long = 2 ^ 16 ' (64 KBytes)
    On Error GoTo ErrExit
    FF = FreeFile
    Open FileName For Binary Access Read As FF
    md5.MD5Init
        Do Until Loc(FF) >= LOF(FF)
            If Loc(FF) + BuffSize > LOF(FF) Then
                ReDim Buff(LOF(FF) - Loc(FF) - 1)
            Else
                ReDim Buff(BuffSize - 1)
            End If
            Get FF, , Buff
            md5.MD5Update UBound(Buff) + 1, Buff
        Loop
        md5.MD5Final
        GetFileMD5 = md5.GetValues
    Close FF
    Exit Function
ErrExit:
    Err.Clear
    GetFileMD5 = ""
End Function

Private Sub Form_Resize()
If Me.WindowState = 1 Then
Me.Visible = False
    Set f_cSystray = New cSystray
    
    With f_cSystray
        If .IsBalloonCapable Then
            .BalloonIcon = TTIconInfo
            .BalloonText = "Reduced"
            .BalloonTitle = "Malware Auto-Downloader " & App.Major & "." & App.Minor
        End If
        .SysTrayIconFromRes "ICON_0"
        .SysTrayToolTip = "Malware Auto-Downloader " & App.Major & "." & App.Minor
        .SysTrayShow True
 If .IsBalloonCapable Then .BalloonShow True, 3000
    End With
    Else
    End If
End Sub

Private Sub Form_Unload(Cancel As Integer) 'todo: need to improve
Set PE = Nothing
Call cdeEcrit
    Set f_cSystray = Nothing
  Unload frmAbout
        On Error Resume Next
    Socket.Close
    Close #Download.F
    Timer1.Enabled = False
Timer2.Enabled = False
If Fichier_Existe(App.path & "\Malware\" & Label1.Caption) = True Then
Kill App.path & "\Malware\" & Label1.Caption
    Else
If Label18.Caption = "1" Then
Unload ircbott
End
Else
End
End If
    End If
End Sub

Private Sub PEinfoCheck_Click() 'scan the pe ? (hardcoded)
If PEinfoCheck.Value = "1" Then
PEinfos.Caption = "1"
Else
PEinfos.Caption = "0"
End If
End Sub

Private Sub PEinfos_Change() 'scan the pe ? (hardcoded)
If PEinfos.Caption = "1" Then
PEinfoCheck.Value = "1"
Else
PEinfoCheck.Value = "0"
End If
End Sub

Private Sub Text3_KeyPress(KeyAscii As Integer) 'only numeric
If (KeyAscii <> vbKeyBack) And Not IsNumeric(Chr(KeyAscii)) Then KeyAscii = 0
End Sub

Private Sub timeeoutcheck_Change() 'if nothing in mad.ini value = 15
If timeeoutcheck.Caption = "" Then
timeoutcheck.text = "15"
Else
End If
End Sub

Private Sub progresstimeout_Change() 'if nothing in mad.ini value = 30
If timeeoutcheck.Caption = "" Then
Text13.text = "30"
Else
End If
End Sub

Private Sub timeoutcheck_KeyPress(KeyAscii As Integer) 'only numeric
If (KeyAscii <> vbKeyBack) And Not IsNumeric(Chr(KeyAscii)) Then KeyAscii = 0
End Sub

Private Sub Text13_KeyPress(KeyAscii As Integer) 'only numeric
If (KeyAscii <> vbKeyBack) And Not IsNumeric(Chr(KeyAscii)) Then KeyAscii = 0
End Sub
'lecture/ecriture de fichier ini by trcdl (coded in 2004)
Public Sub cdeEcrit() 'write mad.ini
    Dim Donnée As String
  Donnée = Label20.Caption
    Call WritePrivateProfileString("MAD INI CONFIG", "Activated", Donnée, App.path + "\MAD.ini")
 'syntaxe : app name, path name, data, path and filename
    Donnée = Text5.text
    Call WritePrivateProfileString("MAD INI CONFIG", "Honeyurl", Donnée, App.path + "\MAD.ini")
    Donnée = Text2.text
    Call WritePrivateProfileString("MAD INI CONFIG", "Honeypassword", Donnée, App.path + "\MAD.ini")
    Donnée = IRCserver.text
    Call WritePrivateProfileString("MAD INI CONFIG", "IRCserver", Donnée, App.path + "\MAD.ini")
    Donnée = IRCport.text
    Call WritePrivateProfileString("MAD INI CONFIG", "IRCport", Donnée, App.path + "\MAD.ini")
    Donnée = IRCchan.text
    Call WritePrivateProfileString("MAD INI CONFIG", "IRCchan", Donnée, App.path + "\MAD.ini")
    Donnée = IRCpseudo.text
    Call WritePrivateProfileString("MAD INI CONFIG", "IRCpseudo", Donnée, App.path + "\MAD.ini")
    Donnée = IRCnickserv.text
    Call WritePrivateProfileString("MAD INI CONFIG", "NickServPassword", Donnée, App.path + "\MAD.ini")
    Donnée = Check2.Value
    Call WritePrivateProfileString("MAD INI CONFIG", "IRC", Donnée, App.path + "\MAD.ini")
    Donnée = PEinfoCheck.Value
    Call WritePrivateProfileString("MAD INI CONFIG", "PEinformations", Donnée, App.path + "\MAD.ini")
    Donnée = timeoutcheck.text
    Call WritePrivateProfileString("MAD INI CONFIG", "Checktimeout", Donnée, App.path + "\MAD.ini")
    Donnée = Text13.text
    Call WritePrivateProfileString("MAD INI CONFIG", "progressbarimeout", Donnée, App.path + "\MAD.ini")
    Donnée = connectstartup.Value
    Call WritePrivateProfileString("MAD INI CONFIG", "IRCstartup", Donnée, App.path + "\MAD.ini")
    Donnée = Text3.text
    Call WritePrivateProfileString("MAD INI CONFIG", "DownloadEvery", Donnée, App.path + "\MAD.ini")
    Donnée = IRCpasswordChan.text
    Call WritePrivateProfileString("MAD INI CONFIG", "ChanelPasswd", Donnée, App.path + "\MAD.ini")
    Donnée = IRCadmin.text
    Call WritePrivateProfileString("MAD INI CONFIG", "IRCAdmin", Donnée, App.path + "\MAD.ini")
    Donnée = IRCusername.text
    Call WritePrivateProfileString("MAD INI CONFIG", "IRCusername", Donnée, App.path + "\MAD.ini")
End Sub

Public Sub cdeLecture() 'read mad.ini
    Dim Taille As Long
    Dim Donnée As String * 100
    Taille = GetPrivateProfileString("MAD INI CONFIG", "Activated", " ", Donnée, 100, App.path + "\MAD.ini")
    Label20.Caption = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "Honeyurl", " ", Donnée, 100, App.path + "\MAD.ini")
    Text5.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "Honeypassword", " ", Donnée, 100, App.path + "\MAD.ini")
    Text2.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "IRCserver", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCserver.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "IRCport", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCport.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "IRCchan", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCchan.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "IRCpseudo", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCpseudo.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "NickServPassword", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCnickserv.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "IRC", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCLabel.Caption = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "PEinformations", " ", Donnée, 100, App.path + "\MAD.ini")
    PEinfos.Caption = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "Checktimeout", " ", Donnée, 100, App.path + "\MAD.ini")
    timeeoutcheck.Caption = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "progressbarimeout", " ", Donnée, 100, App.path + "\MAD.ini")
    progresstimeout.Caption = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "IRCstartup", " ", Donnée, 100, App.path + "\MAD.ini")
    connectvalueirc.Caption = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "DownloadEvery", " ", Donnée, 100, App.path + "\MAD.ini")
    Text3.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "ChanelPasswd", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCpasswordChan.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "IRCAdmin", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCadmin.text = Mid(Donnée, 1, Taille)
    Taille = GetPrivateProfileString("MAD INI CONFIG", "IRCusername", " ", Donnée, 100, App.path + "\MAD.ini")
    IRCusername.text = Mid(Donnée, 1, Taille)
End Sub
'if found the md5 code in google if i remember correctly
Private Sub md5_Click() 'get md5 of file
Text4.text = GetFileMD5(App.path & "\Malware\" & Label1.Caption)
Open App.path & "\Malware\" & "Information.TxT" For Append As #1
Print #1, Date & " - " & Time & " - " & Text4.text & "_" & Label7.Caption & ".ViR" & " - " & UrlToDownload.text
Close #1
Label2.Caption = Text4.text & ".Temp.ViR"
MalwarePE.text = App.path & "\Malware\" & Text4.text & "_" & Label7.Caption & ".ViR"
End Sub

Private Sub Thanks_Click() 'about
frmAbout.show
End Sub

Private Sub Timer1_Timer() 'the hours timer (vb6 timers have a limited interval)
seconde.text = seconde.text + 1
bbqseconde = 60 - seconde.text
bbqminute = 59 - minute.text
bbqheure = Text3.text - heure.text - 1
StatusBar1.Panels(1).text = "Next download: " & bbqheure & ":" & bbqminute & ":" & bbqseconde & " - Stay tuned."

If seconde.text = "60" Then
minute.text = minute.text + 1 'when 60 sec so +1 to min and 0 to sec
bbqminute = 59 - minute.text
seconde.text = "0"
End If

If minute.text = "60" Then
heure.text = heure.text + 1 'when 60 min so +1 to hours and 0 to min
minute.text = "0"
End If

If heure.text = Text3.text Then 'let's download again !
    Socket.Close
    StatusBar1.Panels(1).text = "Status: Let's goooooo... (Bullet For My Valentine - Tears Don't Fall)"
    Close #Download.F
heure.text = "0"
minute.text = "0"
seconde.text = "0"
Call Command1_Click
End If
End Sub

Private Sub Socket_Close()
Timer2.Enabled = False
    StatusBar1.Panels(1).text = "Status: Download Terminated - we will wait: " & Text3.text & " hours, stay tuned !"
    FinishStatus
    Close #Download.F
    Download.F = 0
    Socket.Close
    Call md5_Click
    If Fichier_Existe(App.path & "\Malware\" & Text4.text & "_" & Label7.Caption & ".ViR") = True Then
     Kill App.path & "\Malware\" & Text4.text & "_" & Label7.Caption & ".ViR"
     Name App.path & "\Malware\" & Label1.Caption As App.path & "\Malware\" & Text4.text & "_" & Label7.Caption & ".ViR"
    
        If ircform2.Caption = "1" Then
    ircbott.NewMalcodeFound.text = "PRIVMSG " & frm_Main.IRCchan.text & " :[MAD] 18.:: 7OK ::. " & Label9.Caption
    ircbott.s3nd.Caption = ircbott.NewMalcodeFound.text
    Else
    End If
    
    Else 'omg, new malware found !
        If ircform2.Caption = "1" Then
    ircbott.NewMalcodeFound.text = "PRIVMSG " & frm_Main.IRCchan.text & " :[MAD] 18.:: 4NEW ::. " & frm_Main.Text4.text & " - " & frm_Main.malwareirc.text
    ircbott.s3nd.Caption = frm_Main.Text4.text
    Else
End If
     Name App.path & "\Malware\" & Label1.Caption As App.path & "\Malware\" & Text4.text & "_" & Label7.Caption & ".ViR"
    Set f_cSystray = New cSystray
    With f_cSystray
        If .IsBalloonCapable Then
            .BalloonIcon = TTIconInfo
            .BalloonText = "New MD5 Found: " & Text4.text & "_" & Label7.Caption & ".ViR"
            .BalloonTitle = "Malware Auto-Downloader " & App.Major & "." & App.Minor
        End If
        .SysTrayIconFromRes "ICON_0"
        .SysTrayToolTip = "Malware Auto-Downloader " & App.Major & "." & App.Minor
        .SysTrayShow True
 If .IsBalloonCapable Then .BalloonShow True, 3000
    End With
    If PEinfoCheck.Value = "1" Then 'scan the PE ?
Call GEtPEinfos_Click
Else
End If
If Check1.Value = 1 Then 'send the info to a malware monitoring center ?
If PEinfoCheck.Value = 1 Then 'send also PE info to the malware monitoring center ?
'Syntax.: Get.php?url=URL&md5=MD5&filename=FILE.EXE&info=INFO&password=PASSWORD
'Exemple: Get.php?url=http://www.badsite.com&md5=27CE0A0C691DDF2E931B02071E42FF8C&filename=malware.exe&info=n/a&password=1
HoneyPot.Navigate Text5.text & "?url=" & Decoupe(Adr, "/", True, 3) & "&md5=" & Text4.text & "&filename=" & Label7.Caption & "&info=" & txt.text & "&password=" & Text2.text
Exit Sub
Else
HoneyPot.Navigate Text5.text & "?url=" & Decoupe(Adr, "/", True, 3) & "&md5=" & Text4.text & "&filename=" & Label7.Caption & "&info=n/a&password=" & Text2.text
Exit Sub
End If
End If

End If
    Call Command1_Click
End Sub

     Public Function Fichier_Existe(path As String) As Boolean 'File exist function
     If Dir(path) = "" Then
     Fichier_Existe = False
     Else
     Fichier_Existe = True
  End If
     End Function

Private Sub random_Change() 'random (not really)
If random.Caption < 1000 Then
random.Caption = Int(9999 * Rnd)
End If
End Sub

Private Sub Socket_Connect()
    Dim strHeader As String
    
    strHeader = "GET " & Download.strRequest & " HTTP/1.0" & vbCrLf & _
                "Host: " & Download.strHost & vbCrLf & _
                "Connection: close" & vbCrLf & _
                "Accept: */*" & vbCrLf & _
                "Accept-Encoding: binary" & vbCrLf & vbCrLf
                
    Download.lngStart = GetTickCount 'Download started at this time
    StatusBar1.Panels(1).text = "Status: Connected"
    
    If Socket.State = sckConnected Then
        Socket.SendData strHeader
    End If
End Sub

Private Sub Socket_DataArrival(ByVal bytesTotal As Long)
    Dim strData As String
    If Not bytesTotal = 0 Then 'Length is not 0
        Socket.GetData strData, vbString, bytesTotal
        
        'Check if a filehandle exists
        If Download.F = 0 Then
            Socket.Close
            Exit Sub
        End If
        
        If Left(strData, 4) = "HTTP" Then
            'HTTP Header in Packet
            ProcessHeader strData
        Else
            'File-Content
            ProcessContent strData
        End If
    End If
End Sub

Sub ProcessHeader(ByVal strData As String)
    Dim strStatus() As String
    Dim strHeader As String
    Dim strSub As String
    Dim strLocation As String
    Dim i As Integer
    
    i = InStr(strData, vbCrLf & vbCrLf)
    If Not i = 0 Then
        'Trim Header from Data
        strHeader = Left(strData, i - 1)
        strData = Mid(strData, i + 4)
                    
        'HTTP Status
        strSub = Split(strHeader, vbCrLf)(0)
        strStatus = Split(strSub, " ")   'HTTP/1.0 200 OK
                                         'strStatus(1) = 200
                                            
        If strStatus(1) = "200" Then   '200 = OK/Found
            'Collect Informations
            i = InStr(1, strHeader, "Content-Length: ", vbTextCompare) 'Filesize
            If Not i = 0 Then
                strSub = Mid(strHeader, i + Len("Content-Length: "))
                i = InStr(strSub, vbCrLf)
                If Not i = 0 Then
                    Download.lngLength = Val(Left(strSub, i - 1))
                Else
                    Download.lngLength = Val(strSub)
                End If
            Else
                Download.lngLength = -1
                'Unknown size
            End If
            
            'Header had content attached
            If Len(strData) <> 0 Then
                'Size was not 0
                Put #Download.F, , strData 'Save
                Download.lngRec = Len(strData)
            End If
        ElseIf strStatus(1) = "302" Then    'Redirection
            'Location: http://new.url.com
            i = InStr(1, strHeader, "Location: ", vbTextCompare)
            If Not i = 0 Then
                StatusBar1.Panels(1).text = "Status: Redirection"
                strSub = Mid(strHeader, i + Len("Location: "))
                i = InStr(strSub, vbCrLf)
                If Not i = 0 Then
                    strLocation = Left(strSub, i - 1)
                Else
                    strLocation = strSub
                End If
                ParseUrl strLocation, Download.strHost, Download.strPort, Download.strRequest
                If Not Val(Download.strPort) = 0 Then
                    PB.Value = 100
                    Socket.Close
                    Socket.Connect Download.strHost, Download.strPort
                Else
                    PB.Value = 100
                    MsgBox "Error: The new Location URL is not valid.", vbOKOnly + vbExclamation, "Error"
                End If
            End If
        ElseIf strStatus(1) = "404" Then
            PB.Value = 100
            StatusBar1.Panels(1).text = "Error: File not found"
            Close #Download.F
            Download.F = 0
            Socket.Close
        Else
            'Fehler
            Debug.Print strHeader
            Socket.Close
            Close
            StatusBar1.Panels(1).text = "Error: Unknown Status (" & strStatus(1) & " " & strStatus(2) & ")"
        End If
    End If
End Sub

Sub ProcessContent(ByVal strData As String)
    Dim lngPos As Long
    lngPos = (LOF(Download.F) + 1) 'File-Pos
    If lngPos = 0 Then
        Put #Download.F, , strData
    Else
        Put #Download.F, lngPos, strData
    End If
    Download.lngRec = Download.lngRec + Len(strData)
    ProcessStatus
End Sub

Sub ProcessStatus()
    Dim lngTimed As Long
    Dim lngRemain As Long
    Dim lngSpeed As Long
    On Error Resume Next
    If Download.lngStatusTime = 0 Then
        Download.lngStatusTime = GetTickCount
    End If
    If (GetTickCount - Download.lngStatusTime) / 1000 >= 1 Then
        'Update all second
        Download.lngStatusTime = GetTickCount
        'Speed
        lngTimed = (GetTickCount - Download.lngStart) / 1000
        lngSpeed = Download.lngRec / lngTimed
        'Remaining
        lngRemain = (Download.lngLength - Download.lngRec) / lngSpeed
        'Display Status
        PB.Value = Download.lngRec / Download.lngLength * 100
    End If
End Sub

Sub FinishStatus() 'in standby for the moment
    lbl_Done.Caption = "100%"
    PB.Value = 100
End Sub

Private Sub add_Click() 'add a malware
reponse = InputBox("URL :", "Add a malware", "http://")
If reponse = "" Then
Exit Sub
Else
List_Url.AddItem reponse
End If
End Sub

Private Sub proceed_Click() 'proceed the malware list
If List_Url.ListCount = 0 Then
Exit Sub
End If
If a = List_Url.ListCount Then
a = 0
End If
b = a + 1
If a < List_Url.ListCount Then
UrlToDownload.text = List_Url.List(a)
List_Url.Selected(a) = True
a = a + 1
Else
a = 0
End If
SampleNumber.Caption = "[" & b & "/" & List_Url.ListCount & "]"
End Sub

Private Sub Remove_Click() 'item remove
On Error Resume Next
List_Url.RemoveItem List_Url.ListIndex
End Sub

Public Sub Load_Click() 'load malcode.txt
List_Url.Clear
On Error Resume Next
Open App.path & "\" & "malcode.TxT" For Input As #1
While Not EOF(1)
    Line Input #1, ligne
    List_Url.AddItem ligne
Wend
Close #1
End Sub

Public Sub sauvgarde_Click()
If List_Url.ListCount = 0 Then 'save malcode.txt
Exit Sub
End If
Dim x As Integer
Dim Var
For x = 0 To List_Url.ListCount - 1
    If Var = "" Then
        Var = List_Url.List(x)
    Else
        Var = Var & vbCrLf & List_Url.List(x)
    End If
Next x
Open App.path & "\malcode.TxT" For Output As #1
Print #1, Var
Close #1
End Sub

Private Sub Timer2_Timer() 'hardcoded timeout, todo: need to improve
    If PB.Value <= Text13.text Then
        StatusBar1.Panels(1).text = "TIMEOUT: " & UrlToDownload.text & " !"
        Close #1
        Open App.path & "\Malware\" & "Information.TxT" For Append As #1
        Print #1, Date & " - " & Time & " -  Timeout: " & UrlToDownload.text
        Close #1
        Kill App.path & "\Malware\" & Label1.Caption 'kill it with fire !
        Socket.Close
        Close #Download.F
        Download.F = 0
        Socket.Close
        Timer2.Enabled = False
        Call Command1_Click
    Else
    If PB.Value = "100" Then
        StatusBar1.Panels(1).text = "TIMEOUT: " & UrlToDownload.text & " !"
        Close #1
        Open App.path & "\Malware\" & "Information.TxT" For Append As #1
        Print #1, Date & " - " & Time & " -  Timeout: " & UrlToDownload.text
        Close #1
     If Fichier_Existe(App.path & "\Malware\" & Label1.Caption) = True Then 'file exist?
        Kill App.path & "\Malware\" & Label1.Caption
        Socket.Close
        Close #Download.F
        Download.F = 0
        Socket.Close
        Timer2.Enabled = False
        Call Command1_Click
     Else
        Socket.Close
        Close #Download.F
        Download.F = 0
        Socket.Close
        Timer2.Enabled = False
        Call Command1_Click
    End If
    End If
    End If
End Sub

 Public Function RcpNom(Adresse As String, Optional AcExt As Boolean = True) As String
 If (Len(Adresse) < 4) Or (InStr(Adresse, "/") = 0) Then Exit Function
 If AcExt Then RcpNom = Decoupe(Adresse, "/") Else RcpNom = Decoupe(Decoupe(Adresse, "/"), ".", True)
 End Function 'url decoupe

 Private Function Decoupe(Chn As String, Chr As String, Optional DcpLft As Boolean = False, Optional Ct As Long = 2000000000) As String
 Dim Nb As Long, Cpt As Long
 Nb = InStr(Chn, Chr)
 Do While (InStr(Nb + 1, Chn, Chr) <> 0) And (Cpt < Ct)
 Nb = InStr(Nb + 1, Chn, Chr)
 Cpt = Cpt + 1
 Loop

 If Nb = 0 Then Decoupe = Chn: Exit Function
 If DcpLft Then Decoupe = Left(Chn, Nb - 1) Else Decoupe = Right(Chn, Len(Chn) - Nb)
 End Function 'url decoupe

Private Sub Timer3_Timer() 'Launch IRC bot
Call Command13_Click 'ircbott.show
ircbott.Visible = False
StatusBar1.Panels(1).text = "Time to start chasing the bad guys ;)"
Timer3.Enabled = False
End Sub

Private Sub UrlToDownload_Change() 'hardcoded
Label8.Caption = UrlToDownload.text
malwareirc.text = UrlToDownload.text
End Sub

Public Sub startup()
'Check the startup registry key and if found 'refresh' the regkey
With c
        .ClassKey = HKEY_CURRENT_USER
        .SectionKey = "Software\Microsoft\Windows\CurrentVersion\Run"
        .ValueType = REG_SZ
        .ValueKey = "MAD"
         startupbox.text = .Value
End With

If startupbox.text = "" Then
Check3.Value = 0
Else
Check3.Value = 1
With c
        .ClassKey = HKEY_CURRENT_USER
        .SectionKey = "Software\Microsoft\Windows\CurrentVersion\Run"
        .ValueType = REG_SZ
        .ValueKey = "MAD"
        .Value = App.path & "\" & App.EXEName & ".exe"
End With
End If
End Sub

Private Sub Check3_Click()
'Startup registry entry, cRegistry CLS, really awesome !
If Check3.Value = 1 Then
With c
        .ClassKey = HKEY_CURRENT_USER
        .SectionKey = "Software\Microsoft\Windows\CurrentVersion\Run"
        .ValueType = REG_SZ
        .ValueKey = "MAD"
        .Value = App.path & "\" & App.EXEName & ".exe"
End With
ElseIf Check3.Value = 0 Then
With c
        .ClassKey = HKEY_CURRENT_USER
        .SectionKey = "Software\Microsoft\Windows\CurrentVersion\Run"
        .ValueKey = "MAD"
        .DeleteValue
End With
End If
End Sub
