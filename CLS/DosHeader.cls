VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
  Persistable = 0  'NotPersistable
  DataBindingBehavior = 0  'vbNone
  DataSourceBehavior  = 0  'vbNone
  MTSTransactionMode  = 0  'NotAnMTSObject
END
Attribute VB_Name = "DosHeader"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Dim st As IMAGE_DOS_HEADER, fOwner As PE
Friend Property Get Struct() As IMAGE_DOS_HEADER
Struct = st
End Property
Friend Property Let Struct(n As IMAGE_DOS_HEADER)
st = n
End Property
Friend Sub SetOwner(cOwner As PE)
Set fOwner = cOwner
End Sub
Friend Property Get Owner() As PE
Set Owner = fOwner
End Property
'***********************************************************************
'**********Common Routines For Memory Mapping**************************
Property Get Length() As Long
Length = Len(st)
End Property
Property Get Pointer() As Long
Pointer = VarPtr(st)
End Property
Function Fill(ByVal hMem As Long) As Boolean
On Error Resume Next
If IsBadCodePtr(hMem) Then Exit Function
CopyMemory ByVal Pointer, ByVal hMem, Length
Fill = True
End Function
Function CopyTo(ByVal hMem As Long) As Boolean
If IsBadCodePtr(hMem) Then Exit Function
CopyMemory ByVal hMem, st, Length
CopyTo = True
End Function

'***************End Of Common Routine**************************************
'**************************************************************************

'*****************************************************************
Property Get lFaNew() As Long
lFaNew = st.e_lfanew
End Property
Property Get Magic() As Long
Magic = st.e_magic
End Property

